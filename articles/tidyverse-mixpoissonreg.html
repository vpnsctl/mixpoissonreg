<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>mixpoissonreg in the tidyverse • mixpoissonreg</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="mixpoissonreg in the tidyverse">
<meta property="og:description" content="mixpoissonreg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mixpoissonreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mixpoissonreg.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ggplot2-plots-mixpoissonreg.html">Building and customizing ggplot2-based diagnostic plots with the mixpoissonreg package</a>
    </li>
    <li>
      <a href="../articles/influence-mixpoissonreg.html">Global and local influence analysis with the *mixpoissonreg* package</a>
    </li>
    <li>
      <a href="../articles/intervals-mixpoissonreg.html">Confidence and prediction intervals with  the mixpoissonreg package</a>
    </li>
    <li>
      <a href="../articles/ml-mixpoissonreg.html">Maximum-likelihood estimation with the mixpoissonreg package</a>
    </li>
    <li>
      <a href="../articles/plots-mixpoissonreg.html">Building and customizing base-R diagnostic plots with the mixpoissonreg package</a>
    </li>
    <li>
      <a href="../articles/tidyverse-mixpoissonreg.html">mixpoissonreg in the tidyverse</a>
    </li>
    <li>
      <a href="../articles/tutorial-mixpoissonreg.html">Analyzing overdispersed count data with the mixpoissonreg package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/vpnsctl/mixpoissonreg/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="tidyverse-mixpoissonreg_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>mixpoissonreg in the tidyverse</h1>
                        <h4 class="author">Alexandre B. Simas</h4>
            
            <h4 class="date">2021-03-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/vpnsctl/mixpoissonreg/blob/master/vignettes/tidyverse-mixpoissonreg.Rmd"><code>vignettes/tidyverse-mixpoissonreg.Rmd</code></a></small>
      <div class="hidden name"><code>tidyverse-mixpoissonreg.Rmd</code></div>

    </div>

    
    
<div id="augment-glance-and-tidy-methods" class="section level1">
<h1 class="hasAnchor">
<a href="#augment-glance-and-tidy-methods" class="anchor"></a><code>augment</code>, <code>glance</code> and <code>tidy</code> methods</h1>
<p>The <code>mixpoissonreg</code> package provides the <code>augment</code>, <code>glance</code> and <code>tidy</code> methods following the same spirit as the corresponding methods found in the <code>broom</code> package.</p>
<p>We will now provide a few examples of outputs and applications of these methods to <code>mixpoissonreg</code> objects.</p>
<div id="augment" class="section level2">
<h2 class="hasAnchor">
<a href="#augment" class="anchor"></a><code>augment</code>
</h2>
<p>The <code>augment</code> method for <code>mixpoissonreg</code> objects provides a <code><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble::tibble</a></code> with several important quantities such as residuals, Cook’s distance, generalized Cook’s distance, the model’s matrix, confidence intervals for the means, etc.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vpnsctl/mixpoissonreg/">mixpoissonreg</a></span><span class="op">)</span>

<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixpoissonreg.html">mixpoissonreg</a></span><span class="op">(</span><span class="va">daysabs</span> <span class="op">~</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">math</span> <span class="op">+</span> <span class="va">prog</span> <span class="op">|</span> <span class="va">prog</span>, 
                       model <span class="op">=</span> <span class="st">"PIG"</span>, data <span class="op">=</span> <span class="va">Attendance</span><span class="op">)</span>

<span class="fu"><a href="../reference/augment.mixpoissonreg.html">augment</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 314 x 12</span>
<span class="co">#&gt;    daysabs gender  math prog       .fitted .fittedlwrconf .fitteduprconf  .resid</span>
<span class="co">#&gt;      &lt;dbl&gt; &lt;fct&gt;  &lt;dbl&gt; &lt;fct&gt;        &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt;  1       4 male      63 Academic      5.00           3.91           6.41 -0.158 </span>
<span class="co">#&gt;  2       4 male      27 Academic      6.62           5.23           8.37 -0.316 </span>
<span class="co">#&gt;  3       2 female    20 Academic      9.27           7.23          11.9  -0.634 </span>
<span class="co">#&gt;  4       3 female    16 Academic      9.56           7.39          12.4  -0.555 </span>
<span class="co">#&gt;  5       3 female     2 Academic     10.7            7.94          14.3  -0.584 </span>
<span class="co">#&gt;  6      13 female    71 Academic      6.24           4.80           8.10  0.862 </span>
<span class="co">#&gt;  7      11 female    63 Academic      6.64           5.20           8.47  0.524 </span>
<span class="co">#&gt;  8       7 male       3 Academic      7.98           5.98          10.6  -0.0985</span>
<span class="co">#&gt;  9      10 male      51 Academic      5.49           4.37           6.91  0.648 </span>
<span class="co">#&gt; 10       9 male      49 Vocational    2.52           1.81           3.52  1.57  </span>
<span class="co">#&gt; # … with 304 more rows, and 4 more variables: .resfit &lt;dbl&gt;, .hat &lt;dbl&gt;,</span>
<span class="co">#&gt; #   .cooksd &lt;dbl&gt;, .gencooksd &lt;dbl&gt;</span></code></pre></div>
<p>One can also set the type of fitted values by changing the <code>type.predict</code> argument, where the options are “response” (the default), “link”, “precision”, “variance”.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/augment.mixpoissonreg.html">augment</a></span><span class="op">(</span><span class="va">fit</span>, type.predict <span class="op">=</span> <span class="st">"link"</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 314 x 12</span>
<span class="co">#&gt;    daysabs gender  math prog       .fitted .fittedlwrconf .fitteduprconf  .resid</span>
<span class="co">#&gt;      &lt;dbl&gt; &lt;fct&gt;  &lt;dbl&gt; &lt;fct&gt;        &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt;  1       4 male      63 Academic     1.61           1.36            1.86 -0.158 </span>
<span class="co">#&gt;  2       4 male      27 Academic     1.89           1.66            2.13 -0.316 </span>
<span class="co">#&gt;  3       2 female    20 Academic     2.23           1.98            2.48 -0.634 </span>
<span class="co">#&gt;  4       3 female    16 Academic     2.26           2.00            2.52 -0.555 </span>
<span class="co">#&gt;  5       3 female     2 Academic     2.37           2.07            2.66 -0.584 </span>
<span class="co">#&gt;  6      13 female    71 Academic     1.83           1.57            2.09  0.862 </span>
<span class="co">#&gt;  7      11 female    63 Academic     1.89           1.65            2.14  0.524 </span>
<span class="co">#&gt;  8       7 male       3 Academic     2.08           1.79            2.36 -0.0985</span>
<span class="co">#&gt;  9      10 male      51 Academic     1.70           1.47            1.93  0.648 </span>
<span class="co">#&gt; 10       9 male      49 Vocational   0.926          0.594           1.26  1.57  </span>
<span class="co">#&gt; # … with 304 more rows, and 4 more variables: .resfit &lt;dbl&gt;, .hat &lt;dbl&gt;,</span>
<span class="co">#&gt; #   .cooksd &lt;dbl&gt;, .gencooksd &lt;dbl&gt;</span></code></pre></div>
<p>If <code>type.predict</code> is “link”, one can set <code>se_fit</code> to <code>TRUE</code> to obtain standard errors for the mean parameters in the linear predictor scale.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/augment.mixpoissonreg.html">augment</a></span><span class="op">(</span><span class="va">fit</span>, type.predict <span class="op">=</span> <span class="st">"link"</span>, se_fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 314 x 13</span>
<span class="co">#&gt;    daysabs gender  math prog       .fitted .se.fit .fittedlwrconf .fitteduprconf</span>
<span class="co">#&gt;      &lt;dbl&gt; &lt;fct&gt;  &lt;dbl&gt; &lt;fct&gt;        &lt;dbl&gt;   &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;</span>
<span class="co">#&gt;  1       4 male      63 Academic     1.61    0.126          1.36            1.86</span>
<span class="co">#&gt;  2       4 male      27 Academic     1.89    0.120          1.66            2.13</span>
<span class="co">#&gt;  3       2 female    20 Academic     2.23    0.127          1.98            2.48</span>
<span class="co">#&gt;  4       3 female    16 Academic     2.26    0.131          2.00            2.52</span>
<span class="co">#&gt;  5       3 female     2 Academic     2.37    0.151          2.07            2.66</span>
<span class="co">#&gt;  6      13 female    71 Academic     1.83    0.133          1.57            2.09</span>
<span class="co">#&gt;  7      11 female    63 Academic     1.89    0.125          1.65            2.14</span>
<span class="co">#&gt;  8       7 male       3 Academic     2.08    0.147          1.79            2.36</span>
<span class="co">#&gt;  9      10 male      51 Academic     1.70    0.117          1.47            1.93</span>
<span class="co">#&gt; 10       9 male      49 Vocational   0.926   0.169          0.594           1.26</span>
<span class="co">#&gt; # … with 304 more rows, and 5 more variables: .resid &lt;dbl&gt;, .resfit &lt;dbl&gt;,</span>
<span class="co">#&gt; #   .hat &lt;dbl&gt;, .cooksd &lt;dbl&gt;, .gencooksd &lt;dbl&gt;</span></code></pre></div>
<p>By default the <code>augment</code> method returns the Pearson’s residuals. To return the score residuals one simply has to set the <code>type.residuals</code> argument to “score”:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/augment.mixpoissonreg.html">augment</a></span><span class="op">(</span><span class="va">fit</span>, type.residuals <span class="op">=</span> <span class="st">"score"</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 314 x 12</span>
<span class="co">#&gt;    daysabs gender  math prog      .fitted .fittedlwrconf .fitteduprconf   .resid</span>
<span class="co">#&gt;      &lt;dbl&gt; &lt;fct&gt;  &lt;dbl&gt; &lt;fct&gt;       &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt;  1       4 male      63 Academic     5.00           3.91           6.41  0.189  </span>
<span class="co">#&gt;  2       4 male      27 Academic     6.62           5.23           8.37 -0.00561</span>
<span class="co">#&gt;  3       2 female    20 Academic     9.27           7.23          11.9  -0.839  </span>
<span class="co">#&gt;  4       3 female    16 Academic     9.56           7.39          12.4  -0.542  </span>
<span class="co">#&gt;  5       3 female     2 Academic    10.7            7.94          14.3  -0.642  </span>
<span class="co">#&gt;  6      13 female    71 Academic     6.24           4.80           8.10  0.980  </span>
<span class="co">#&gt;  7      11 female    63 Academic     6.64           5.20           8.47  0.790  </span>
<span class="co">#&gt;  8       7 male       3 Academic     7.98           5.98          10.6   0.312  </span>
<span class="co">#&gt;  9      10 male      51 Academic     5.49           4.37           6.91  0.851  </span>
<span class="co">#&gt; 10       9 male      49 Vocation…    2.52           1.81           3.52  1.11   </span>
<span class="co">#&gt; # … with 304 more rows, and 4 more variables: .resfit &lt;dbl&gt;, .hat &lt;dbl&gt;,</span>
<span class="co">#&gt; #   .cooksd &lt;dbl&gt;, .gencooksd &lt;dbl&gt;</span></code></pre></div>
<p>It is possible to obtain predictions for newdata by using the <code>newdata</code> argument. To such an end, the <code>newdata</code> argument must be set to a <code>data.frame</code> object containing the values of the covariates for which the predictions are desired. For example:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/augment.mixpoissonreg.html">augment</a></span><span class="op">(</span><span class="va">fit</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>gender <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"male"</span>, <span class="st">"female"</span><span class="op">)</span>, math <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">34</span>, <span class="fl">85</span><span class="op">)</span>, 
                                  prog <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"General"</span>, <span class="st">"Academic"</span><span class="op">)</span>, 
                                  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"General"</span>, <span class="st">"Academic"</span>, <span class="st">"Vocational"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2 x 6</span>
<span class="co">#&gt;   gender  math prog     .fitted .fittedlwrconf .fitteduprconf</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;dbl&gt; &lt;fct&gt;      &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;</span>
<span class="co">#&gt; 1 male      34 General     9.57           7.36          12.5 </span>
<span class="co">#&gt; 2 female    85 Academic    5.59           4.14           7.55</span></code></pre></div>
<p>Notice that in the above example the confidence intervals for the means were returned by default. However, it is important to obtain prediction intervals, i.e., intervals for which the future observations will fall with the prescribed probability. It is important to notice that since we did not obtain an approximate distribution for the response variable, we obtain the prediction intervals by simulation, which is computationally intensive.</p>
<p>To obtain prediction intervals, one must set the <code>pred_int</code> argument to <code>TRUE</code>. The prescribed probability can be set by entering the <code>level</code> argument, the default level is 0.95. With respect to the simulation to obtain prediction intervals, one can change the number of mean and prediction parameters generated by setting the <code>nsim_pred</code> argument to the desired value, the default is 100, and also can change the number of response variables <em>y</em> generated for each pair of mean and precision parameters by setting the <code>nsim_pred_y</code> to the desired value, the default is 100. Finally, we can also set <code>conf_int</code> to <code>FALSE</code> to remove the confidence intervals for the mean.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/augment.mixpoissonreg.html">augment</a></span><span class="op">(</span><span class="va">fit</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>gender <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"male"</span>, <span class="st">"female"</span><span class="op">)</span>, math <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">34</span>, <span class="fl">85</span><span class="op">)</span>, 
                                  prog <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"General"</span>, <span class="st">"Academic"</span><span class="op">)</span>, 
                                  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"General"</span>, <span class="st">"Academic"</span>, <span class="st">"Vocational"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
        pred_int <span class="op">=</span> <span class="cn">TRUE</span>, level <span class="op">=</span> <span class="fl">0.99</span>,
        nsim_pred <span class="op">=</span> <span class="fl">50</span>, nsim_pred_y  <span class="op">=</span><span class="fl">50</span>,
        conf_int <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; Warning in predict.mixpoissonreg(x, newdata = newdata, type = "response", :</span>
<span class="co">#&gt; predictions on current data refer to _future_ responses</span>
<span class="co">#&gt; # A tibble: 2 x 6</span>
<span class="co">#&gt;   gender  math prog     .fitted .fittedlwrpred .fitteduprpred</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;dbl&gt; &lt;fct&gt;      &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;</span>
<span class="co">#&gt; 1 male      34 General     9.57              0             40</span>
<span class="co">#&gt; 2 female    85 Academic    5.59              0             49</span></code></pre></div>
<p>With the <code>augment</code> method it is simple to sort the observations by their Cook’s distance or by their generalized Cook’s distance along with their indexes and the model’s matrix in order to facilitate the study of their influence:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>

<span class="fu"><a href="../reference/augment.mixpoissonreg.html">augment</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>.index <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">.cooksd</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">.index</span>, <span class="va">daysabs</span>, <span class="va">gender</span>, <span class="va">math</span>,<span class="va">prog</span>,<span class="va">.cooksd</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 314 x 6</span>
<span class="co">#&gt;    .index daysabs gender  math prog       .cooksd</span>
<span class="co">#&gt;     &lt;int&gt;   &lt;dbl&gt; &lt;fct&gt;  &lt;dbl&gt; &lt;fct&gt;        &lt;dbl&gt;</span>
<span class="co">#&gt;  1    186      16 male      81 Vocational  0.271 </span>
<span class="co">#&gt;  2    260      19 male      49 Vocational  0.261 </span>
<span class="co">#&gt;  3     94      29 female    70 General     0.171 </span>
<span class="co">#&gt;  4     79      35 male       1 Academic    0.147 </span>
<span class="co">#&gt;  5    188      16 female    75 Vocational  0.123 </span>
<span class="co">#&gt;  6    150      34 female    29 General     0.108 </span>
<span class="co">#&gt;  7     57      28 male       5 General     0.0977</span>
<span class="co">#&gt;  8    254      14 male      43 Vocational  0.0826</span>
<span class="co">#&gt;  9     53      27 male      48 Academic    0.0824</span>
<span class="co">#&gt; 10    105      19 male      70 General     0.0776</span>
<span class="co">#&gt; # … with 304 more rows</span></code></pre></div>
<p>and</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/augment.mixpoissonreg.html">augment</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>.index <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">.gencooksd</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">.index</span>, <span class="va">daysabs</span>, <span class="va">gender</span>, <span class="va">math</span>,<span class="va">prog</span>,<span class="va">.gencooksd</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 314 x 6</span>
<span class="co">#&gt;    .index daysabs gender  math prog       .gencooksd</span>
<span class="co">#&gt;     &lt;int&gt;   &lt;dbl&gt; &lt;fct&gt;  &lt;dbl&gt; &lt;fct&gt;           &lt;dbl&gt;</span>
<span class="co">#&gt;  1     94      29 female    70 General        0.0739</span>
<span class="co">#&gt;  2    105      19 male      70 General        0.0398</span>
<span class="co">#&gt;  3    150      34 female    29 General        0.0362</span>
<span class="co">#&gt;  4    143       5 female     7 General        0.0350</span>
<span class="co">#&gt;  5     57      28 male       5 General        0.0308</span>
<span class="co">#&gt;  6    186      16 male      81 Vocational     0.0273</span>
<span class="co">#&gt;  7    265      16 female    99 General        0.0239</span>
<span class="co">#&gt;  8    235       3 female    67 General        0.0234</span>
<span class="co">#&gt;  9    260      19 male      49 Vocational     0.0222</span>
<span class="co">#&gt; 10     28       0 female    21 Academic       0.0221</span>
<span class="co">#&gt; # … with 304 more rows</span></code></pre></div>
<p>Finally, it is easy to use the <code>augment</code> method to build useful plots. For instance, let us consider a new model containing only “math” as covariate and let us create confidence intervals for the means and prediction intervals for the response variables.</p>
<p>First, the plot with confidence intervals for the means:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>

<span class="va">fit_math</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixpoissonreg.html">mixpoissonreg</a></span><span class="op">(</span><span class="va">daysabs</span> <span class="op">~</span> <span class="va">math</span>, 
                        data <span class="op">=</span> <span class="va">Attendance</span><span class="op">)</span>

<span class="va">fit_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/augment.mixpoissonreg.html">augment</a></span><span class="op">(</span><span class="va">fit_math</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">math</span>, <span class="va">daysabs</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="st">"Math Score"</span> <span class="op">=</span> <span class="va">math</span>, <span class="st">"Days Abscent"</span> <span class="op">=</span> <span class="va">daysabs</span><span class="op">)</span>

<span class="va">new_math</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, by<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span>

<span class="va">fit_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/augment.mixpoissonreg.html">augment</a></span><span class="op">(</span><span class="va">fit_math</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>math <span class="op">=</span> <span class="va">new_math</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="st">"Math Score"</span> <span class="op">=</span> <span class="va">math</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="st">"Days Abscent"</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">fit_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">`Math Score`</span>, y <span class="op">=</span> <span class="va">`Days Abscent`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">fit_math</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> 
                                        <span class="va">fit_math</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">x</span><span class="op">)</span><span class="op">}</span>, colour <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fit_int</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">.fittedlwrconf</span>, ymax <span class="op">=</span> <span class="va">.fitteduprconf</span><span class="op">)</span>, 
              fill <span class="op">=</span> <span class="st">"grey70"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></code></pre></div>
<p><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>Observe that the confidence intervals tend to be narrow. They are confidence intervals for the means, not for the response variables. The intervals that play the role of “confidence intervals” for response variables are the prediction intervals, which are much wider and provide estimate of intervals for which future observations will fall with the prescribed probability.</p>
<p>Now the plot containing the predictions intervals for the response variables:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/augment.mixpoissonreg.html">augment</a></span><span class="op">(</span><span class="va">fit_math</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>math <span class="op">=</span> <span class="va">new_math</span><span class="op">)</span>, 
                   pred_int <span class="op">=</span> <span class="cn">TRUE</span>, nsim_pred <span class="op">=</span> <span class="fl">50</span>, nsim_pred_y <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="st">"Math Score"</span> <span class="op">=</span> <span class="va">math</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="st">"Days Abscent"</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">fit_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">`Math Score`</span>, y <span class="op">=</span> <span class="va">`Days Abscent`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">fit_math</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> 
                                        <span class="va">fit_math</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">x</span><span class="op">)</span><span class="op">}</span>, colour <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fit_pred</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">.fittedlwrpred</span>, ymax <span class="op">=</span> <span class="va">.fitteduprpred</span><span class="op">)</span>, 
              fill <span class="op">=</span> <span class="st">"grey70"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></code></pre></div>
<p><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div id="glance" class="section level2">
<h2 class="hasAnchor">
<a href="#glance" class="anchor"></a><code>glance</code>
</h2>
<p>The <code>glance</code> method for <code>mixpoissonreg</code> objects only contains one argument, which is the fitted <code>mixpoissonreg</code> object. It returns a <code><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble::tibble</a></code> with useful information for constructing tests and also for comparing different fits:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/glance.mixpoissonreg.html">glance</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 9</span>
<span class="co">#&gt;   efron.pseudo.r2 df.null logLik   AIC   BIC df.residual  nobs model.type</span>
<span class="co">#&gt;             &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;int&gt; &lt;int&gt; &lt;chr&gt;     </span>
<span class="co">#&gt; 1           0.186     312  -858. 1731. 1761.         306   314 PIG       </span>
<span class="co">#&gt; # … with 1 more variable: est.method &lt;chr&gt;</span></code></pre></div>
<p>Notice that it also contains Efron’s pseudo-<span class="math inline">\(R^2\)</span>, which is essentially an indicator of how well the future predictions will typically be. Basically, if the variance of the response is very high, even though the model may be able to provide a good estimate of the mean, the mean may be a poor estimate of the response variable.</p>
</div>
<div id="tidy" class="section level2">
<h2 class="hasAnchor">
<a href="#tidy" class="anchor"></a><code>tidy</code>
</h2>
<p>The <code>tidy</code> method for <code>mixpoissonreg</code> objects provide the parameter’s estimates along with their standard errors, <em>z</em>-statistics and <em>p</em>-values. It has two arguments, a logical <code>conf.int</code> indicating whether confidence intervals for the parameters should be returned and <code>conf.level</code> indicating the confidence level, the default level is 0.95.</p>
<p>For example:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/tidy.mixpoissonreg.html">tidy</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 8 x 6</span>
<span class="co">#&gt;   component term           estimate std.error statistic  p.value</span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 mean      (Intercept)     2.81      0.162       17.3  5.02e-67</span>
<span class="co">#&gt; 2 mean      gendermale     -0.282     0.123       -2.30 2.15e- 2</span>
<span class="co">#&gt; 3 mean      math           -0.00777   0.00240     -3.24 1.20e- 3</span>
<span class="co">#&gt; 4 mean      progAcademic   -0.423     0.148       -2.86 4.28e- 3</span>
<span class="co">#&gt; 5 mean      progVocational -1.22      0.197       -6.16 7.11e-10</span>
<span class="co">#&gt; 6 precision (Intercept)     0.928     0.331        2.80 5.04e- 3</span>
<span class="co">#&gt; 7 precision progAcademic   -1.28      0.385       -3.32 8.94e- 4</span>
<span class="co">#&gt; 8 precision progVocational -1.74      0.451       -3.87 1.09e- 4</span></code></pre></div>
<p>and</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/tidy.mixpoissonreg.html">tidy</a></span><span class="op">(</span><span class="va">fit</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 8 x 8</span>
<span class="co">#&gt;   component term        estimate std.error statistic  p.value conf.low conf.high</span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt; 1 mean      (Intercept)  2.81      0.162       17.3  5.02e-67   2.49     3.12   </span>
<span class="co">#&gt; 2 mean      gendermale  -0.282     0.123       -2.30 2.15e- 2  -0.523   -0.0417 </span>
<span class="co">#&gt; 3 mean      math        -0.00777   0.00240     -3.24 1.20e- 3  -0.0125  -0.00307</span>
<span class="co">#&gt; 4 mean      progAcadem… -0.423     0.148       -2.86 4.28e- 3  -0.713   -0.133  </span>
<span class="co">#&gt; 5 mean      progVocati… -1.22      0.197       -6.16 7.11e-10  -1.60    -0.829  </span>
<span class="co">#&gt; 6 precision (Intercept)  0.928     0.331        2.80 5.04e- 3   0.279    1.58   </span>
<span class="co">#&gt; 7 precision progAcadem… -1.28      0.385       -3.32 8.94e- 4  -2.03    -0.525  </span>
<span class="co">#&gt; 8 precision progVocati… -1.74      0.451       -3.87 1.09e- 4  -2.63    -0.861</span></code></pre></div>
<p>One can also use the <code>tidy</code> method to build plots of the mean-related coefficients and precision-related coefficients with confidence intervals:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/tidy.mixpoissonreg.html">tidy</a></span><span class="op">(</span><span class="va">fit</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">term</span>, y <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">conf.low</span>, ymax <span class="op">=</span> <span class="va">conf.high</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle<span class="op">=</span><span class="fl">45</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Coefficient"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Estimate"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">component</span><span class="op">)</span></code></pre></div>
<p><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>or separately (since the precision regression structure does not contain all the covariates)</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span>

<span class="va">pmean</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tidy.mixpoissonreg.html">tidy</a></span><span class="op">(</span><span class="va">fit</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">component</span> <span class="op">==</span> <span class="st">"mean"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">term</span>, y <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">conf.low</span>, ymax <span class="op">=</span> <span class="va">conf.high</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle<span class="op">=</span><span class="fl">45</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Coefficient"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Estimate"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">component</span><span class="op">)</span>

<span class="va">pprecision</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tidy.mixpoissonreg.html">tidy</a></span><span class="op">(</span><span class="va">fit</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">component</span> <span class="op">==</span> <span class="st">"precision"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">term</span>, y <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">conf.low</span>, ymax <span class="op">=</span> <span class="va">conf.high</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle<span class="op">=</span><span class="fl">45</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Coefficient"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">component</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">pmean</span>, <span class="va">pprecision</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
</div>
<div id="tidy_local_influence-and-local_influence_benchmarks-methods" class="section level1">
<h1 class="hasAnchor">
<a href="#tidy_local_influence-and-local_influence_benchmarks-methods" class="anchor"></a><code>tidy_local_influence</code> and <code>local_influence_benchmarks</code> methods</h1>
<p>The <code>tidy_local_influence</code> method for <code>mixpoissonreg</code> objects has, besides the <code>model</code> argument, all the arguments of the <code>local_influence</code> method for <code>mixpoissonreg</code> objects. For details on these arguments we refer the reader to the <a href="influence-mixpoissonreg.html">Global and local influence analysis with the <em>mixpoissonreg</em> package</a> vignette.</p>
<p>When we call the <code>tidy_local_influence</code> method it returns a nice <code><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble::tibble</a></code> containing the curvatures under the chosen perturbation schemes. For example:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/tidy_local_influence.html">tidy_local_influence</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 314 x 5</span>
<span class="co">#&gt;    case_weights hidden_variable mean_explanatory precision_explanatory</span>
<span class="co">#&gt;           &lt;dbl&gt;           &lt;dbl&gt;            &lt;dbl&gt;                 &lt;dbl&gt;</span>
<span class="co">#&gt;  1     0.000948        0.000493         0.000358             0.00255  </span>
<span class="co">#&gt;  2     0.000526        0.000433         0.000580             0.00191  </span>
<span class="co">#&gt;  3     0.00155         0.000516         0.000518             0.0000402</span>
<span class="co">#&gt;  4     0.000380        0.000527         0.000737             0.000191 </span>
<span class="co">#&gt;  5     0.000841        0.000732         0.000867             0.0000561</span>
<span class="co">#&gt;  6     0.00200         0.00472          0.00447              0.00233  </span>
<span class="co">#&gt;  7     0.00186         0.00279          0.00347              0.00302  </span>
<span class="co">#&gt;  8     0.00143         0.00167          0.00186              0.00315  </span>
<span class="co">#&gt;  9     0.00179         0.00221          0.00220              0.00277  </span>
<span class="co">#&gt; 10     0.00335         0.00396          0.000388             0.00298  </span>
<span class="co">#&gt; # … with 304 more rows, and 1 more variable: simultaneous_explanatory &lt;dbl&gt;</span></code></pre></div>
<p>One can, for instance, change the curvature and the direction:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/tidy_local_influence.html">tidy_local_influence</a></span><span class="op">(</span><span class="va">fit</span>, curvature <span class="op">=</span> <span class="st">"normal"</span>,
                     direction <span class="op">=</span> <span class="st">"max.eigen"</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 314 x 5</span>
<span class="co">#&gt;    case_weights hidden_variable mean_explanatory precision_explanatory</span>
<span class="co">#&gt;           &lt;dbl&gt;           &lt;dbl&gt;            &lt;dbl&gt;                 &lt;dbl&gt;</span>
<span class="co">#&gt;  1     -0.0541          0.00496          -0.0189              -0.0505 </span>
<span class="co">#&gt;  2     -0.0379         -0.00703          -0.0241              -0.0437 </span>
<span class="co">#&gt;  3      0.0587         -0.0174           -0.0228               0.00634</span>
<span class="co">#&gt;  4      0.0199         -0.0234           -0.0272              -0.0138 </span>
<span class="co">#&gt;  5      0.0308         -0.0283           -0.0294              -0.00749</span>
<span class="co">#&gt;  6     -0.0641         -0.0255           -0.0668              -0.0482 </span>
<span class="co">#&gt;  7     -0.0713         -0.0286           -0.0589              -0.0549 </span>
<span class="co">#&gt;  8     -0.0641         -0.0260           -0.0432              -0.0561 </span>
<span class="co">#&gt;  9     -0.0719          0.00166          -0.0469              -0.0527 </span>
<span class="co">#&gt; 10     -0.00232         0.0122           -0.0197              -0.0546 </span>
<span class="co">#&gt; # … with 304 more rows, and 1 more variable: simultaneous_explanatory &lt;dbl&gt;</span></code></pre></div>
<p>Useful plots of the local influence measures can be obtained by using the <code>local_influence_autoplot</code> method.</p>
<p>The <code>local_influence_benchmarks</code> method for <code>mixpoissonreg</code> objects returns the benchmarks for the different perturbation schemes. We use the benchmarks suggested by <a href="https://doi.org/10.1111/1467-9868.00279">Zhu and Lee (2001)</a> for conformal normal curvatures and the benchmarks suggested by <a href="https://www.springer.com/gp/book/9781441902993">Verbeke and Molenberghs (2000, sect. 11.3)</a> for normal curvatures. For <code>direction = "max.eigen"</code>, no benchmark is provided.</p>
<p>When we call the <code>local_influence_benchmarks</code> method it returns a <code><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble::tibble</a></code> containing the benchmarks for the chosen perturbation schemes. For example:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/tidy_local_influence.html">local_influence_benchmarks</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 5</span>
<span class="co">#&gt;   case_weights hidden_variable mean_explanatory precision_explanatory</span>
<span class="co">#&gt;          &lt;dbl&gt;           &lt;dbl&gt;            &lt;dbl&gt;                 &lt;dbl&gt;</span>
<span class="co">#&gt; 1       0.0114          0.0162           0.0196                0.0149</span>
<span class="co">#&gt; # … with 1 more variable: simultaneous_explanatory &lt;dbl&gt;</span></code></pre></div>
<p>One possible application is the following: select the observations whose curvature are above the benchmarks, then <code>left_join</code> this <code>tibble</code> with a subset of the <code>tibble</code> returned by the <code>augment</code> method containing the model’s matrix. This facilitates the study of the influential observations.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>

<span class="va">inf_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tidy_local_influence.html">tidy_local_influence</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>.index <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">.index</span>, names_to <span class="op">=</span> <span class="st">"perturbation"</span>, values_to <span class="op">=</span> <span class="st">"curvature"</span><span class="op">)</span> 
<span class="va">bench_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tidy_local_influence.html">local_influence_benchmarks</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"perturbation"</span>, values_to <span class="op">=</span> <span class="st">"benchmark"</span><span class="op">)</span>

<span class="va">inf_bench_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">inf_tbl</span>, <span class="va">bench_tbl</span>, by <span class="op">=</span> <span class="st">"perturbation"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>influential <span class="op">=</span> <span class="va">curvature</span> <span class="op">&gt;</span> <span class="va">benchmark</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">influential</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">influential</span>, <span class="op">-</span><span class="va">benchmark</span>, <span class="op">-</span><span class="va">curvature</span><span class="op">)</span>

<span class="va">data_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/augment.mixpoissonreg.html">augment</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>.index <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">.index</span>, <span class="va">daysabs</span>, <span class="va">gender</span>, <span class="va">math</span>, <span class="va">prog</span><span class="op">)</span>

<span class="va">influential</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">inf_bench_tbl</span>, <span class="va">data_tbl</span>, by <span class="op">=</span> <span class="st">".index"</span><span class="op">)</span>

<span class="va">influential</span>
<span class="co">#&gt; # A tibble: 64 x 6</span>
<span class="co">#&gt;    .index perturbation             daysabs gender  math prog    </span>
<span class="co">#&gt;     &lt;int&gt; &lt;chr&gt;                      &lt;dbl&gt; &lt;fct&gt;  &lt;dbl&gt; &lt;fct&gt;   </span>
<span class="co">#&gt;  1     20 hidden_variable               24 male       4 Academic</span>
<span class="co">#&gt;  2     20 mean_explanatory              24 male       4 Academic</span>
<span class="co">#&gt;  3     20 simultaneous_explanatory      24 male       4 Academic</span>
<span class="co">#&gt;  4     28 case_weights                   0 female    21 Academic</span>
<span class="co">#&gt;  5     31 case_weights                   0 male       1 Academic</span>
<span class="co">#&gt;  6     36 hidden_variable               28 female    20 Academic</span>
<span class="co">#&gt;  7     36 mean_explanatory              28 female    20 Academic</span>
<span class="co">#&gt;  8     36 simultaneous_explanatory      28 female    20 Academic</span>
<span class="co">#&gt;  9     39 precision_explanatory          5 male       1 General </span>
<span class="co">#&gt; 10     40 mean_explanatory              27 female    35 Academic</span>
<span class="co">#&gt; # … with 54 more rows</span></code></pre></div>
<p>It is easy to see that the above <code>tibble</code> is very helpful in the study of influential observations.</p>
<p>One can also easily count how many observations have curvature above the benchmark considering all the perturbation schemes:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">influential</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">.index</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 1</span>
<span class="co">#&gt;       n</span>
<span class="co">#&gt;   &lt;int&gt;</span>
<span class="co">#&gt; 1    28</span></code></pre></div>
</div>
<div id="autoplot-and-local_influence_autoplot-methods" class="section level1">
<h1 class="hasAnchor">
<a href="#autoplot-and-local_influence_autoplot-methods" class="anchor"></a><code>autoplot</code> and <code>local_influence_autoplot</code> methods</h1>
<p>The <code>autoplot</code> method for <code>mixpoissonreg</code> objects provides 6 useful plots for diagnostic analysis. By default, it provides the following plots: “Residuals vs Obs. number”, “Normal Q-Q”, “Cook’s dist vs Generalized Cook’s dist” and “Response vs Fitted means”. These plots are obtained by simply calling the <code>autoplot</code> method:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/autoplot.mixpoissonreg.html">autoplot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code></pre></div>
<p><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-22-1.png" width="700"><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-22-2.png" width="700"><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-22-3.png" width="700"><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-22-4.png" width="700"></p>
<p>Notice that it automatically identify the <code>label.n</code> most extreme points. The default value for <code>label.n</code> is 3.</p>
<p>If the model is fitted with simulated envelopes, then the envelopes are automatically plotted. In the example below we will consider the estimation obtained by direct maximization of likelihood function to reduce computational cost.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_env</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixpoissonregML.html">mixpoissonregML</a></span><span class="op">(</span><span class="va">daysabs</span> <span class="op">~</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">math</span> <span class="op">+</span> <span class="va">prog</span> <span class="op">|</span> <span class="va">prog</span>, 
                       model <span class="op">=</span> <span class="st">"PIG"</span>, data <span class="op">=</span> <span class="va">Attendance</span>,
                       envelope <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>

<span class="fu"><a href="../reference/autoplot.mixpoissonreg.html">autoplot</a></span><span class="op">(</span><span class="va">fit_env</span><span class="op">)</span></code></pre></div>
<p><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-23-1.png" width="700"><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-23-2.png" width="700"><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-23-3.png" width="700"><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-23-4.png" width="700"></p>
<p>We can easily plot Cook’s distance and generalized Cook’s distance by including in the <code>which</code> argument the numbers 3 (Cook’s distance) and 4 (generalized Cook’s distance):</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/autoplot.mixpoissonreg.html">autoplot</a></span><span class="op">(</span><span class="va">fit</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-24-1.png" width="700"><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-24-2.png" width="700"></p>
<p>There are also several options to customize the appearance of the plots. Several of these options are presented in the <a href="https://vpnsctl.github.io/mixpoissonreg/articles/ggplot2-plots-mixpoissonreg.html">Building and customizing ggplot2-based diagnostic plots with the mixpoissonreg package</a> vignette.</p>
<p>The <code>local_influence_autoplot</code> provides plots of the curvatures under the perturbation schemes for all the possible combinations of arguments of the <code>local_influence</code> method. We refer the reader to the <a href="influence-mixpoissonreg.html">Global and local influence analysis with the <em>mixpoissonreg</em> package</a> vignette for further details on these arguments.</p>
<p>If the <code>direction</code> argument is set to “canonical” (the default), then the <code>n.influential</code> points above the <em>benchmarks</em> are automatically identified, where the default value for <code>n.influential</code> is 5. Recall that we use the benchmarks suggested by <a href="https://doi.org/10.1111/1467-9868.00279">Zhu and Lee (2001)</a> for conformal normal curvatures and the benchmarks suggested by <a href="https://www.springer.com/gp/book/9781441902993">Verbeke and Molenberghs (2000, sect. 11.3)</a> for normal curvatures. For <code>direction = "max.eigen"</code>, no benchmark is provided. In this case, the <code>local_influence_autoplot</code> method automatically identifies the <code>n.influential</code> most extremes points.</p>
<p>Let us build these plots. First, the standard arguments provide the plots of conformal normal curvature in the canonical directions for the “case_weights”, “hidden_variable”, “mean_explanatory” and “precision_explanatory” perturbation schemes with “case_weights” and “hidden_variable” being computed for all parameters, and the explanatory perturbations being computed for all covariates:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/tidy_local_influence.html">local_influence_autoplot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code></pre></div>
<p><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-25-1.png" width="700"><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-25-2.png" width="700"><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-25-3.png" width="700"><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-25-4.png" width="700"></p>
<p>To change to normal curvature simply set the <code>curvature</code> argument to “normal”:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/tidy_local_influence.html">local_influence_autoplot</a></span><span class="op">(</span><span class="va">fit</span>, curvature <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></code></pre></div>
<p><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-26-1.png" width="700"><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-26-2.png" width="700"><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-26-3.png" width="700"><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-26-4.png" width="700"></p>
<p>We can change the perturbations schemes to be displayed by providing a list or vector containing the numbers relative to the wanted perturbations. The number 1 is the <em>case weights</em> perturbation, number 2 is the <em>hidden variable</em> perturbation, number 3 is <em>mean explanatory</em> perturbation, number 4 is <em>precision explanatory</em> perturbation and number 5 is <em>simultaneous explanatory</em> perturbation.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/tidy_local_influence.html">local_influence_autoplot</a></span><span class="op">(</span><span class="va">fit</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-27-1.png" width="700"><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-27-2.png" width="700"></p>
<p>We can draw the benchmark line (when <code>direction</code> is “canonical”) by setting the <code>draw.benchmark</code> argument to <code>TRUE</code>:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/tidy_local_influence.html">local_influence_autoplot</a></span><span class="op">(</span><span class="va">fit</span>, draw.benchmark <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-28-1.png" width="700"><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-28-2.png" width="700"><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-28-3.png" width="700"><img src="tidyverse-mixpoissonreg_files/figure-html/unnamed-chunk-28-4.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Alexandre B. Simas, Wagner Barreto-Souza.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
