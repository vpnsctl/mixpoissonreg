<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Maximum-likelihood estimation with the mixpoissonreg package • mixpoissonreg</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Maximum-likelihood estimation with the mixpoissonreg package">
<meta property="og:description" content="mixpoissonreg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mixpoissonreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mixpoissonreg.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/influence-mixpoissonreg.html">Global and local influence analysis with the *mixpoissonreg* package</a>
    </li>
    <li>
      <a href="../articles/intervals-mixpoissonreg.html">Confidence and prediction intervals with  the mixpoissonreg package</a>
    </li>
    <li>
      <a href="../articles/ml-mixpoissonreg.html">Maximum-likelihood estimation with the mixpoissonreg package</a>
    </li>
    <li>
      <a href="../articles/plots-mixpoissonreg.html">Diagnostic plots with the mixpoissonreg package</a>
    </li>
    <li>
      <a href="../articles/tidyverse-mixpoissonreg.html">mixpoissonreg in the tidyverse</a>
    </li>
    <li>
      <a href="../articles/tutorial-mixpoissonreg.html">Analyzing overdispersed count data with the mixpoissonreg package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/vpnsctl/mixpoissonreg/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ml-mixpoissonreg_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Maximum-likelihood estimation with the mixpoissonreg package</h1>
                        <h4 class="author">Alexandre B. Simas</h4>
            
            <h4 class="date">2021-02-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/vpnsctl/mixpoissonreg/blob/master/vignettes/ml-mixpoissonreg.Rmd"><code>vignettes/ml-mixpoissonreg.Rmd</code></a></small>
      <div class="hidden name"><code>ml-mixpoissonreg.Rmd</code></div>

    </div>

    
    
<div id="fitting-mixpoissonreg-models-via-direct-maximization-of-the-likelihood-function" class="section level1">
<h1 class="hasAnchor">
<a href="#fitting-mixpoissonreg-models-via-direct-maximization-of-the-likelihood-function" class="anchor"></a>Fitting <code>mixpoissonreg</code> models via direct maximization of the likelihood function</h1>
<p>In the <code>mixpoissonreg</code> package one can easily obtain estimates for the parameters of the model through direct maximization of likelihood function. This estimation procedure has the advantage of being very fast, so we recommend this estimation as an alternative when the EM-algorithm takes too long to converge. We use <strong>very good</strong> initial guesses using the <code>gamlss</code> function from the <code>gamlss</code> package.</p>
<p>One can obtain parameters estimates through direct maximization of the likelihood function by setting the <code>method</code> argument to “ML”:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vpnsctl/mixpoissonreg/">mixpoissonreg</a></span><span class="op">)</span>

<span class="va">fit_ml</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixpoissonreg.html">mixpoissonreg</a></span><span class="op">(</span><span class="va">daysabs</span> <span class="op">~</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">math</span> <span class="op">+</span> <span class="va">prog</span>, method <span class="op">=</span> <span class="st">"ML"</span>, 
                        data <span class="op">=</span> <span class="va">Attendance</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_ml</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Negative Binomial Regression - Maximum-Likelihood Estimation</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; mixpoissonreg(formula = daysabs ~ gender + math + prog, data = Attendance, </span>
<span class="co">#&gt;     method = "ML")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Pearson residuals:</span>
<span class="co">#&gt;      RSS      Min       1Q   Median       3Q      Max </span>
<span class="co">#&gt; 345.7857  -0.9662  -0.7356  -0.3351   0.3132   5.5512 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients modeling the mean (with  link):</span>
<span class="co">#&gt;                 Estimate Std.error z-value Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)     2.707564  0.203069  13.333  &lt; 2e-16 ***</span>
<span class="co">#&gt; gendermale     -0.211066  0.122373  -1.725   0.0846 .  </span>
<span class="co">#&gt; math           -0.006235  0.002491  -2.503   0.0123 *  </span>
<span class="co">#&gt; progAcademic   -0.424576  0.181772  -2.336   0.0195 *  </span>
<span class="co">#&gt; progVocational -1.252813  0.201381  -6.221 4.94e-10 ***</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients modeling the precision (with  link):</span>
<span class="co">#&gt;             Estimate Std.error z-value Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)   1.0473    0.1082   9.675   &lt;2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Efron's pseudo R-squared:  0.1854615 </span>
<span class="co">#&gt; Number of function calls by 'optim' = 4</span></code></pre></div>
<p>These estimates can also be obtained by using the <code>mixpoissonregML</code> function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_ml2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixpoissonregML.html">mixpoissonregML</a></span><span class="op">(</span><span class="va">daysabs</span> <span class="op">~</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">math</span> <span class="op">+</span> <span class="va">prog</span>,
                        data <span class="op">=</span> <span class="va">Attendance</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_ml2</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Negative Binomial Regression - Maximum-Likelihood Estimation</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; mixpoissonregML(formula = daysabs ~ gender + math + prog, data = Attendance)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Pearson residuals:</span>
<span class="co">#&gt;      RSS      Min       1Q   Median       3Q      Max </span>
<span class="co">#&gt; 345.7857  -0.9662  -0.7356  -0.3351   0.3132   5.5512 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients modeling the mean (with  link):</span>
<span class="co">#&gt;                 Estimate Std.error z-value Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)     2.707564  0.203069  13.333  &lt; 2e-16 ***</span>
<span class="co">#&gt; gendermale     -0.211066  0.122373  -1.725   0.0846 .  </span>
<span class="co">#&gt; math           -0.006235  0.002491  -2.503   0.0123 *  </span>
<span class="co">#&gt; progAcademic   -0.424576  0.181772  -2.336   0.0195 *  </span>
<span class="co">#&gt; progVocational -1.252813  0.201381  -6.221 4.94e-10 ***</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients modeling the precision (with  link):</span>
<span class="co">#&gt;             Estimate Std.error z-value Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)   1.0473    0.1082   9.675   &lt;2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Efron's pseudo R-squared:  0.1854615 </span>
<span class="co">#&gt; Number of function calls by 'optim' = 4</span></code></pre></div>
<p>Notice that both of these methods produce identical estimates:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fit_ml</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fit_ml2</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>Both of these functions return objects of class <code>mixpoissonreg</code> and therefore all these methods are available for them: <code>summary</code>, <code>plot</code>, <code>coef</code>, <code>predict</code>, <code>fitted</code>, <code>influence</code>, <code>hatvalues</code>, <code>cooks.distance</code>, <code>local_influence</code>, <code>local_influence</code>, <code>local_influence_plot</code>, <code>augment</code>, <code>glance</code>, <code>tidy</code>, <code>tidy_local_influence</code>, <code>local_influence_benchmarks</code>, <code>autoplot</code>, <code>local_influence_autoplot</code>. One can also use the <code>lrtest</code>, <code>waldtest</code>, <code>coeftest</code> and <code>coefci</code> methods from the <code>lmtest</code> package to them.</p>
<p>By using the structure <code>formula_1 | formula_2</code>, one can define a regression structure for the mean using <code>formula_1</code> (which must contain the reponse variable) and a regression structure for the precision parameter using <code>formula_2</code> (which must <strong>not</strong> contain the response variable). To fit a Poisson Inverse Gaussian regression model just set the <code>model</code> argument to “PIG”. To change the link function for the mean parameter by changing the <code>link.mean</code> parameter (the possible link functions for the mean are “log” and “sqrt”). Analogously, to change the link function for the precision parameter, one must change the <code>link.precision</code> parameter (the possible link functions for the precision parameter are “identity”, “log” and “inverse.sqrt”).</p>
<p>For instance:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_ml_prec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixpoissonregML.html">mixpoissonregML</a></span><span class="op">(</span><span class="va">daysabs</span> <span class="op">~</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">math</span> <span class="op">+</span> <span class="va">prog</span> <span class="op">|</span> <span class="va">prog</span>,
                        model <span class="op">=</span> <span class="st">"PIG"</span>, data <span class="op">=</span> <span class="va">Attendance</span><span class="op">)</span>

<span class="fu"><a href="../reference/autoplot.mixpoissonreg.html">autoplot</a></span><span class="op">(</span><span class="va">fit_ml_prec</span><span class="op">)</span></code></pre></div>
<p><img src="ml-mixpoissonreg_files/figure-html/unnamed-chunk-5-1.png" width="700"><img src="ml-mixpoissonreg_files/figure-html/unnamed-chunk-5-2.png" width="700"><img src="ml-mixpoissonreg_files/figure-html/unnamed-chunk-5-3.png" width="700"><img src="ml-mixpoissonreg_files/figure-html/unnamed-chunk-5-4.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="../reference/tidy_local_influence.html">local_influence_autoplot</a></span><span class="op">(</span><span class="va">fit_ml_prec</span><span class="op">)</span></code></pre></div>
<p><img src="ml-mixpoissonreg_files/figure-html/unnamed-chunk-5-5.png" width="700"><img src="ml-mixpoissonreg_files/figure-html/unnamed-chunk-5-6.png" width="700"><img src="ml-mixpoissonreg_files/figure-html/unnamed-chunk-5-7.png" width="700"><img src="ml-mixpoissonreg_files/figure-html/unnamed-chunk-5-8.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html">lrtest</a></span><span class="op">(</span><span class="va">fit_ml_prec</span><span class="op">)</span>
<span class="co">#&gt; Likelihood ratio test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model 1: daysabs ~ gender + math + prog | prog</span>
<span class="co">#&gt; Model 2: daysabs ~ 1 | prog</span>
<span class="co">#&gt;   #Df  LogLik Df  Chisq Pr(&gt;Chisq)    </span>
<span class="co">#&gt; 1   8 -857.52                         </span>
<span class="co">#&gt; 2   4 -877.37 -4 39.687  5.024e-08 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="va">fit_ml_reduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixpoissonregML.html">mixpoissonregML</a></span><span class="op">(</span><span class="va">daysabs</span> <span class="op">~</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">math</span> <span class="op">+</span> <span class="va">prog</span>,
                        model <span class="op">=</span> <span class="st">"PIG"</span>, data <span class="op">=</span> <span class="va">Attendance</span><span class="op">)</span>

<span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html">lrtest</a></span><span class="op">(</span><span class="va">fit_ml_prec</span>, <span class="va">fit_ml_reduced</span><span class="op">)</span>
<span class="co">#&gt; Likelihood ratio test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model 1: daysabs ~ gender + math + prog | prog</span>
<span class="co">#&gt; Model 2: daysabs ~ gender + math + prog | 1</span>
<span class="co">#&gt;   #Df  LogLik Df Chisq Pr(&gt;Chisq)    </span>
<span class="co">#&gt; 1   8 -857.52                        </span>
<span class="co">#&gt; 2   6 -864.53 -2 14.01  0.0009075 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p><strong>Remark</strong>: <em>Notice that when using the methods <code><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html">lmtest::lrtest</a></code> and <code><a href="https://rdrr.io/pkg/lmtest/man/waldtest.html">lmtest::waldtest</a></code> to compare more than one model, all the models must be of the same type, that is, they all must be or Negative Binomial regression models or they all must be Poisson Inverse Gaussian regression models.</em></p>
<p>Finally, one can obtain simulated envelopes by setting the <code>envelope</code> argument to the number of draws to be simulated. If there are simulated envelopes, the Q-Q plot from the <code>plot</code> and <code>autoplot</code> methods will contain the envelopes and the <code>summary</code> method will print the percentage of observations within the simulated envelopes. For example:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_ml_env</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixpoissonregML.html">mixpoissonregML</a></span><span class="op">(</span><span class="va">daysabs</span> <span class="op">~</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">math</span> <span class="op">+</span> <span class="va">prog</span> <span class="op">|</span> <span class="va">prog</span>,
                        model <span class="op">=</span> <span class="st">"PIG"</span>, envelope <span class="op">=</span> <span class="fl">100</span>, data <span class="op">=</span> <span class="va">Attendance</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_ml_env</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Poisson Inverse Gaussian Regression - Maximum-Likelihood Estimation</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; mixpoissonregML(formula = daysabs ~ gender + math + prog | prog, </span>
<span class="co">#&gt;     data = Attendance, model = "PIG", envelope = 100)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Pearson residuals:</span>
<span class="co">#&gt;      RSS      Min       1Q   Median       3Q      Max </span>
<span class="co">#&gt; 239.2987  -1.0042  -0.6101  -0.3107   0.2734   4.2816 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients modeling the mean (with  link):</span>
<span class="co">#&gt;                 Estimate Std.error z-value Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)     2.805150  0.162182  17.296  &lt; 2e-16 ***</span>
<span class="co">#&gt; gendermale     -0.282333  0.122772  -2.300  0.02147 *  </span>
<span class="co">#&gt; math           -0.007771  0.002398  -3.240  0.00120 ** </span>
<span class="co">#&gt; progAcademic   -0.422885  0.148011  -2.857  0.00428 ** </span>
<span class="co">#&gt; progVocational -1.215877  0.197261  -6.164  7.1e-10 ***</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients modeling the precision (with  link):</span>
<span class="co">#&gt;                Estimate Std.error z-value Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)      0.9277    0.3308   2.805 0.005038 ** </span>
<span class="co">#&gt; progAcademic    -1.2799    0.3853  -3.322 0.000894 ***</span>
<span class="co">#&gt; progVocational  -1.7440    0.4506  -3.870 0.000109 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Efron's pseudo R-squared:  0.1858035 </span>
<span class="co">#&gt; Percentage of residuals within the envelope = 97.4522</span>
<span class="co">#&gt; Number of function calls by 'optim' = 6</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fit_ml_env</span>, which <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="ml-mixpoissonreg_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="../reference/autoplot.mixpoissonreg.html">autoplot</a></span><span class="op">(</span><span class="va">fit_ml_env</span>, which <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="ml-mixpoissonreg_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
</div>
<div id="obtaining-estimates-without-formulas" class="section level1">
<h1 class="hasAnchor">
<a href="#obtaining-estimates-without-formulas" class="anchor"></a>Obtaining estimates without <em>formulas</em>
</h1>
<p>If one has a matrix <code>X</code> of mean-related covariates, optionally a matrix <code>W</code> of precision-related covariates, and a vector (or one-dimensional matrix) <code>y</code>, one can fit a Mixed Poisson Regression model estimated via direct maximization of the likelihood function without the usage of <em>formulas</em> by using the <code>mixpoissonreg.fit</code> (with <code>method</code> argument set to “ML”) or <code>mixpoissonregML.fit</code>.</p>
<p><strong>Remark</strong>: <em>It is important to notice that these functions</em> <strong><em>do not</em></strong> <em>return <code>mixpoissonreg</code> objects. Instead they return <code>mixpoissonreg_fit</code> objects. This means that several methods that are available for <code>mixpoissonreg</code> objects are</em> <strong><em>not</em></strong> <em>available for <code>mixpoissonreg_fit</code> objects.</em></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"Attendance"</span>, package <span class="op">=</span> <span class="st">"mixpoissonreg"</span><span class="op">)</span>

<span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">Attendance</span><span class="op">$</span><span class="va">math</span><span class="op">)</span>
<span class="va">y</span> <span class="op">=</span> <span class="va">Attendance</span><span class="op">$</span><span class="va">daysabs</span>

<span class="fu"><a href="../reference/mixpoissonregML.html">mixpoissonregML.fit</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span>
<span class="co">#&gt; $mean</span>
<span class="co">#&gt; [1]  2.24664356 -0.01033794</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $precision</span>
<span class="co">#&gt; [1] 0.8558557</span>

<span class="va">W</span> <span class="op">=</span> <span class="va">X</span>

<span class="fu"><a href="../reference/mixpoissonregML.html">mixpoissonregML.fit</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">W</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span>
<span class="co">#&gt; $mean</span>
<span class="co">#&gt; [1]  2.26894432 -0.01082254</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $precision</span>
<span class="co">#&gt; [1]  0.182393957 -0.007273019</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Alexandre B. Simas, Wagner Barreto-Souza.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
