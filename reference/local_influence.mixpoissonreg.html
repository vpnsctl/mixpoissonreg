<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Local Influence Diagnostics for Mixed Poisson Regression Models — local_influence.mixpoissonreg • mixpoissonreg</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/superhero/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Local Influence Diagnostics for Mixed Poisson Regression Models — local_influence.mixpoissonreg" />
<meta property="og:description" content="These functions provides local influence diagnostic quantities. Currently the conformal normal and normal curvatures are available
under several perturbation schemes. The default is the conformal normal curvature since
it takes values on \([0,1]\) and other nice properties (see Zhu and Lee, 2001 and Poon and Poon, 1999 for further details)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mixpoissonreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mixpoissonreg.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/influence-mixpoissonreg.html">influence-mixpoissonreg</a>
    </li>
    <li>
      <a href="../articles/intervals-mixpoissonreg.html">intervals-mixpoissonreg</a>
    </li>
    <li>
      <a href="../articles/ml-mixpoissonreg.html">ml-mixpoissonreg</a>
    </li>
    <li>
      <a href="../articles/plots-mixpoissonreg.html">plots-mixpoissonreg</a>
    </li>
    <li>
      <a href="../articles/tidyverse-mixpoissonreg.html">tidyverse-mixpoissonreg</a>
    </li>
    <li>
      <a href="../articles/tutorial-mixpoissonreg.html">tutorial-mixpoissonreg</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vpnsctl/mixpoissonreg/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Local Influence Diagnostics for Mixed Poisson Regression Models</h1>
    <small class="dont-index">Source: <a href='https://github.com/vpnsctl/mixpoissonreg/blob/master/R/4_local_influence.R'><code>R/4_local_influence.R</code></a></small>
    <div class="hidden name"><code>local_influence.mixpoissonreg.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These functions provides local influence diagnostic quantities. Currently the conformal normal and normal curvatures are available
under several perturbation schemes. The default is the conformal normal curvature since
it takes values on \([0,1]\) and other nice properties (see Zhu and Lee, 2001 and Poon and Poon, 1999 for further details).</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for mixpoissonreg</span>
<span class='fu'><a href='local_influence.html'>local_influence</a></span><span class='op'>(</span>
  <span class='va'>model</span>,
  perturbation <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"case_weights"</span>, <span class='st'>"hidden_variable"</span>, <span class='st'>"mean_explanatory"</span>,
    <span class='st'>"precision_explanatory"</span>, <span class='st'>"simultaneous_explanatory"</span><span class='op'>)</span>,
  curvature <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"conformal"</span>, <span class='st'>"normal"</span><span class='op'>)</span>,
  direction <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"canonical"</span>, <span class='st'>"max.eigen"</span><span class='op'>)</span>,
  parameters <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"all"</span>, <span class='st'>"mean"</span>, <span class='st'>"precision"</span><span class='op'>)</span>,
  mean.covariates <span class='op'>=</span> <span class='cn'>NULL</span>,
  precision.covariates <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S3 method for mixpoissonreg</span>
<span class='fu'><a href='local_influence.html'>local_influence_plot</a></span><span class='op'>(</span>
  <span class='va'>model</span>,
  which <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span><span class='op'>)</span>,
  caption <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='st'>"Case Weights Perturbation"</span>, <span class='st'>"Hidden Variable Perturbation"</span>,
    <span class='st'>"Mean Explanatory Perturbation"</span>, <span class='st'>"Precision Explanatory Perturbation"</span>,
    <span class='st'>"Simultaneous Explanatory Perturbation"</span><span class='op'>)</span>,
  sub.caption <span class='op'>=</span> <span class='cn'>NULL</span>,
  detect.influential <span class='op'>=</span> <span class='cn'>TRUE</span>,
  n.influential <span class='op'>=</span> <span class='fl'>5</span>,
  draw.benchmark <span class='op'>=</span> <span class='cn'>FALSE</span>,
  lty.benchmark <span class='op'>=</span> <span class='fl'>2</span>,
  type_plot <span class='op'>=</span> <span class='st'>"h"</span>,
  curvature <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"conformal"</span>, <span class='st'>"normal"</span><span class='op'>)</span>,
  direction <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"canonical"</span>, <span class='st'>"max.eigen"</span><span class='op'>)</span>,
  parameters <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"all"</span>, <span class='st'>"mean"</span>, <span class='st'>"precision"</span><span class='op'>)</span>,
  mean.covariates <span class='op'>=</span> <span class='cn'>NULL</span>,
  precision.covariates <span class='op'>=</span> <span class='cn'>NULL</span>,
  main <span class='op'>=</span> <span class='st'>""</span>,
  ask <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/prod.html'>prod</a></span><span class='op'>(</span><span class='fu'>graphics</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span><span class='st'>"mfcol"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>which</span><span class='op'>)</span> <span class='op'>&amp;&amp;</span> <span class='fu'>grDevices</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grDevices/dev.interactive.html'>dev.interactive</a></span><span class='op'>(</span><span class='op'>)</span>,
  labels.id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>model</span><span class='op'>)</span><span class='op'>)</span>,
  cex.id <span class='op'>=</span> <span class='fl'>0.75</span>,
  cex.oma.main <span class='op'>=</span> <span class='fl'>1.25</span>,
  cex.caption <span class='op'>=</span> <span class='fl'>1</span>,
  include.modeltype <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>model</th>
      <td><p>a <code>mixpoissonreg</code> object.</p></td>
    </tr>
    <tr>
      <th>perturbation</th>
      <td><p>a list or vector of perturbation schemes to be returned. The currently available schemes are
"case_weights", "hidden_variable", "mean_explanatory", "precision_explanatory", "simultaneous_explanatory". See Barreto-Souza and Simas (2015) for further details.</p></td>
    </tr>
    <tr>
      <th>curvature</th>
      <td><p>the curvature to be returned, 'conformal' for the conformal normal curvature (see Zhu and Lee, 2001 and Poon and Poon, 1999) or
'normal' (see Zhu and Lee, 2001 and Cook, 1986).</p></td>
    </tr>
    <tr>
      <th>direction</th>
      <td><p>the 'max.eigen' returns the eigenvector associated to the largest eigenvalue of the perturbation matrix. The 'canonical' considers
the curvatures under the canonical directions, which is known as "total local curvature" (see Lesaffre and Verbeke, 1998). For conformal
normal curvatures both of them coincide. The default is 'canonical'.</p></td>
    </tr>
    <tr>
      <th>parameters</th>
      <td><p>the parameter to which the local influence will be computed. The options are 'all', 'mean' and 'precision'.
This argument affects the 'case_weights' and 'hidden_variable' perturbation schemes. The default is 'all'.</p></td>
    </tr>
    <tr>
      <th>mean.covariates</th>
      <td><p>a list or vector of characters containing the mean-explanatory variables to be used in the 'mean-explanatory' and 'simultaneous-explanatory'
perturbation schemes. If NULL, the 'mean-explanatory' and 'simultaneous-explanatory' perturbation schemes will be computed by perturbing all
mean-related covariates. The default is NULL.</p></td>
    </tr>
    <tr>
      <th>precision.covariates</th>
      <td><p>a list or vector of characters containing the precision-explanatory variables to be used in the 'precision-explanatory'
and 'simultaneous-explanatory'
perturbation schemes. If NULL, the 'precision-explanatory' and 'simultaneous-explanatory' perturbation schemes will be computed by perturbing all
precision-related covariates. The default is NULL.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other graphical arguments to be passed.</p></td>
    </tr>
    <tr>
      <th>which</th>
      <td><p>a list or vector indicating which plots should be displayed.     If a subset of the plots is required, specify a subset of the numbers 1:5, see caption below (and the 'Details') for the different kinds.</p></td>
    </tr>
    <tr>
      <th>caption</th>
      <td><p>captions to appear above the plots; character vector or list of valid graphics annotations. Can be set to "" or NA to suppress all captions.</p></td>
    </tr>
    <tr>
      <th>sub.caption</th>
      <td><p>common title-above the figures if there are more than one. If NULL, as by default, a possible abbreviated version of deparse(x$call) is used.</p></td>
    </tr>
    <tr>
      <th>detect.influential</th>
      <td><p>logical. Indicates whether the benchmark should be used to detect influential observations and identify them on the plot. If there is no benchmark available,
the top 'n.influential' observations will be identified in the plot by their indexes.</p></td>
    </tr>
    <tr>
      <th>n.influential</th>
      <td><p>interger. The maximum number of influential observations to be identified on the plot.</p></td>
    </tr>
    <tr>
      <th>draw.benchmark</th>
      <td><p>logical. Indicates whether a horizontal line identifying the benchmark should be drawn.</p></td>
    </tr>
    <tr>
      <th>lty.benchmark</th>
      <td><p>the line type of the benchmark if drawn.</p></td>
    </tr>
    <tr>
      <th>type_plot</th>
      <td><p>what type of plot should be drawn. The default is 'h'.</p></td>
    </tr>
    <tr>
      <th>main</th>
      <td><p>character; title to be placed at each plot additionally (and above) all captions.</p></td>
    </tr>
    <tr>
      <th>ask</th>
      <td><p>logical; if <code>TRUE</code>, the user is asked before each plot.</p></td>
    </tr>
    <tr>
      <th>labels.id</th>
      <td><p>vector of labels, from which the labels for extreme points will be chosen. The default uses the observation numbers.</p></td>
    </tr>
    <tr>
      <th>cex.id</th>
      <td><p>magnification of point labels.</p></td>
    </tr>
    <tr>
      <th>cex.oma.main</th>
      <td><p>controls the size of the sub.caption only if that is above the figures when there is more than one.</p></td>
    </tr>
    <tr>
      <th>cex.caption</th>
      <td><p>controls the size of caption.</p></td>
    </tr>
    <tr>
      <th>include.modeltype</th>
      <td><p>logical. Indicates whether the model type ('NB' or 'PIG') should be displayed on the captions.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list containing the resulting perturbation schemes as elements. Each returned element has an attribute 'benchmark', which for
the conformal normal curvature, it is computed following Zhu and Lee (2001), and for normal curvature it is computed following Verbeke and ...
If the 'direction' is 'max.eigen' the 'benchmark' attribute is NA.</p>
<p>The 'mean_explanatory', 'precision_explanatory' and 'simultaneous_explanatory' elements of the list contain an attribute 'covariates' indicating
which covariates were used in the perturbation schemes.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>local_influence.mixpoissonreg</code> provides local influence diagnostics for mixed Poisson regression models for all perturbation schemes considered in
Barreto-Souza and Simas (2015), for normal and conformal normal curvatures. Further, it is also provides results for the canonical directions, which is called
the total local influence (see Lesaffre and Verbeke, 1998), as well as for the direction of largest curvature, which is the direction of the eigenvector of the
perturbation matrix associated to the largest eigenvalue.</p>
<p><code>local_influence_plot.mixpoissonreg</code> provides a plot of the local influence diagnostics. Each plot corresponds to a perturbation scheme. The first plot considers
the 'case-weights' perturbation; the second plot considers the 'hidden-variable' perturbation (which was introduced in Barreto-Souza and Simas, 2015); the third plot
considers the mean-explanatory perturbation; the fourth plot considers the precision-explanatory perturbation; the fifth plot considers the simultanous-explanatory perturbation.</p>
<p>For both <code>local_influence.mixpoissonreg</code> and <code>local_influence_plot.mixpoissonreg</code>, one can select which covariates will be perturbed in the 'mean-explanatory',
'precision-explanatory' and 'simultaneous-explanatory' perturbation schemes. These are chosen in the 'mean.covariates' and 'precision.covariates' arguments.</p>
<p>If one considers the total local influence, then Zhu and Lee (2002) provides benchmark for influential observations for all perturbation schemes. These are returned as
attributes in the returned list from <code>local_influence.mixpoissonreg</code>. When using the <code>local_influence_plot.mixpoissonreg</code>, only points above the benchmark
will be displayed. One can also set the option 'draw_benchmark' to TRUE to plot the benchmark line.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>DOI:10.1007/s11222-015-9601-6 (<a href='https://doi.org/10.1007/s11222-015-9601-6'>Barreto-Souza and Simas; 2015</a>)</p>
<p>Cook, R. D. (1986) <em>Assessment of Local Influence.</em> Journal of the Royal Statistical Society. Series B (Methodological), Vol. 48, pp.133-169. <a href='https://rss.onlinelibrary.wiley.com/doi/10.1111/j.2517-6161.1986.tb01398.x'>https://rss.onlinelibrary.wiley.com/doi/10.1111/j.2517-6161.1986.tb01398.x</a></p>
<p>Lesaffre, E. and Verbeke, G. (1998) <em>Local Influence in Linear Mixed Models</em>. Biometrics, 54, pp. 570-582. <a href='https://www.jstor.org/stable/3109764'>https://www.jstor.org/stable/3109764</a></p>
<p>Poon, W.-Y. and Poon, Y.S. (2002) <em>Conformal normal curvature and assessment of local influence.</em>  Journal of the Royal Statistical Society. Series B (Methodological), Vol. 61, pp.51-61. <a href='https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00162'>https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00162</a></p>
<p>Zhu, H.-T. and Lee, S.-Y. (2002) <em>Local influence for incomplete data models.</em> Journal of the Royal Statistical Society. Series B (Methodological), Vol. 63, pp.111-126. <a href='https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00279'>https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/1467-9868.00279</a></p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alexandre B. Simas, Wagner Barreto-Souza.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


