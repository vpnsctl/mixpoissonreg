<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mixed Poisson Regression for Overdispersed Count Data • mixpoissonreg</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Mixed Poisson Regression for Overdispersed Count Data">
<meta property="og:description" content="Fits mixed Poisson regression models (Poisson-Inverse Gaussian or Negative-Binomial) on data sets with response variables being count data. The models can have varying precision parameter, where a linear regression structure (through a link function) is assumed to hold on the precision parameter. The Expectation-Maximization algorithm for both these models (Poisson Inverse Gaussian and Negative Binomial) is an important contribution of this package. Another important feature of this package is the set of functions to perform global and local influence analysis. See Barreto-Souza and Simas (2015) &lt;doi:10.1007/s11222-015-9601-6&gt; for further details.  ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">mixpoissonreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/mixpoissonreg.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/influence-mixpoissonreg.html">influence-mixpoissonreg</a>
    </li>
    <li>
      <a href="articles/intervals-mixpoissonreg.html">intervals-mixpoissonreg</a>
    </li>
    <li>
      <a href="articles/ml-mixpoissonreg.html">ml-mixpoissonreg</a>
    </li>
    <li>
      <a href="articles/plots-mixpoissonreg.html">plots-mixpoissonreg</a>
    </li>
    <li>
      <a href="articles/tidyverse-mixpoissonreg.html">tidyverse-mixpoissonreg</a>
    </li>
    <li>
      <a href="articles/tutorial-mixpoissonreg.html">tutorial-mixpoissonreg</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/vpnsctl/mixpoissonreg/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="mixpoissonreg" class="section level2">
<h2 class="hasAnchor">
<a href="#mixpoissonreg" class="anchor"></a><strong>mixpoissonreg</strong>
</h2>
<!-- badges: start -->

<p>The <em>mixpoissonreg</em> package deals with regression models with response variables being count data. It is aimed towards overdispersed data. It currently provides implementation of two regression models: Negative Binomial and Poisson Inverse Gaussian regression models. For both of these models, there are two estimation procedures implemented, the EM-algorithm and direct maximization of the log-likelihood function. The definition of both these regression models along with the EM-algorithm approach for them can be found at <a href="http://doi.org/10.1007/s11222-015-9601-6" class="uri">http://doi.org/10.1007/s11222-015-9601-6</a>. The direct maximization of the log-likelihood is only recommended when the EM-algorithm takes too long to converge. Several global and local influence measures are implemented and easy to interpret through plot visualization. There are plot implementations using base-R and <em>ggplot2</em>. For further details, and also more tutorials, we refer the reader to the <strong>vignettes</strong> whose links can be found on the <strong>Articles</strong> menu above or by using <code>vignette(mixpoissonreg)</code>.</p>
</div>
<div id="installing-the-mixpoissonreg-package" class="section level2">
<h2 class="hasAnchor">
<a href="#installing-the-mixpoissonreg-package" class="anchor"></a>Installing the <em>mixpoissonreg</em> package</h2>
<p>The latest development version can be installed from github:</p>
<pre class="{r}"><code><a href="https://devtools.r-lib.org//reference/remote-reexports.html">#install.packages("devtools")
devtools::install_github("vpnsctl/mixpoissonreg")</a></code></pre>
</div>
<div id="dependencies" class="section level2">
<h2 class="hasAnchor">
<a href="#dependencies" class="anchor"></a>Dependencies</h2>
<p>The <em>mixpoissonreg</em> package depends on the <em>Rfast</em> package. The <em>Rfast</em> package needs the <em>GSL</em> library to be installed. If you are using linux, you most likely will need to install the <em>GSL</em> library.</p>
<p>On Ubuntu (version 18.04 or newer), run:</p>
<pre class="{bash}"><code>sudo apt install libgsl-dev</code></pre>
<p>On RedHat or Fedora, run:</p>
<pre class="{bash}"><code>yum install gsl gsl-devel</code></pre>
<p>The <em>mixpoissonreg</em> package also depends on the following packages: <code>pbapply</code>, <code>Formula</code>, <code>gamlss</code>, <code>gamlss.dist</code>, <code>rlang</code>, <code>statmod</code>, <code>lmtest</code>, <code>methods</code>, <code>generics</code>, <code>magrittr</code>, <code>tibble</code>, <code>dplyr</code>, <code>ggplot2</code>, <code>ggfortify</code>, <code>ggrepel</code>, <code>gridExtra</code></p>
</div>
<div id="useful-resources" class="section level2">
<h2 class="hasAnchor">
<a href="#useful-resources" class="anchor"></a>Useful Resources</h2>
<ul>
<li><p><a href="https://vpnsctl.github.io/mixpoissonreg/reference/index.html"><em>mixpoissonreg</em> Documentation</a></p></li>
<li>
<p>Currently, the <em>mixpoissonreg</em> package has the following vignettes:</p>
<ul>
<li><a href="https://vpnsctl.github.io/mixpoissonreg/articles/mixpoissonreg.html">Getting started: Introduction to the <em>mixpoissonreg</em> package</a></li>
<li><a href="https://vpnsctl.github.io/mixpoissonreg/articles/tutorial-mixpoissonreg.html">Analyzing overdispersed count data with the <em>mixpoissonreg</em> package</a></li>
<li><a href="https://vpnsctl.github.io/mixpoissonreg/articles/ml-mixpoissonreg.html">Maximum-likelihood estimation with the <em>mixpoissonreg</em> package</a></li>
<li><a href="https://vpnsctl.github.io/mixpoissonreg/articles/plots-mixpoissonreg.html">Diagnostic plots with the <em>mixpoissonreg</em> package</a></li>
<li><a href="https://vpnsctl.github.io/mixpoissonreg/articles/influence-mixpoissonreg.html">Global and local influence analysis with the <em>mixpoissonreg</em> package</a></li>
<li><a href="https://vpnsctl.github.io/mixpoissonreg/articles/intervals-mixpoissonreg.html">Confidence and predictions intervals with the <em>mixpoissonreg</em> package</a></li>
<li><a href="https://vpnsctl.github.io/mixpoissonreg/articles/tidyverse-mixpoissonreg.html"><em>mixpoissonreg</em> in the <em>tidyverse</em></a></li>
</ul>
</li>
<li><p>Theoretical details can be obtained in <a href="https://doi.org/10.1007/s11222-015-9601-6">Barreto-Souza and Simas (2016)</a> and also in its <a href="https://link.springer.com/article/10.1007%2Fs11222-015-9601-6#Sec23">Supplementary Material</a></p></li>
</ul>
</div>
<div id="basic-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-usage" class="anchor"></a>Basic usage</h2>
<p>The usage of the <em>mixpoissonreg</em> package is analogous to the usage of standard regression functions and packages in <em>R</em>:</p>
<pre class="{r}"><code><a href="https://github.com/vpnsctl/mixpoissonreg/">library(mixpoissonreg)
fit &lt;- mixpoissonreg(daysabs ~ prog + math + gender | prog, data = Attendance)
fit
#&gt; 
#&gt; Negative Binomial Regression - Expectation-Maximization Algorithm
#&gt; 
#&gt; Call:
#&gt; mixpoissonreg(formula = daysabs ~ prog + math + gender | prog, 
#&gt;     data = Attendance)
#&gt; 
#&gt; Coefficients modeling the mean (with log link):
#&gt;    (Intercept)   progAcademic progVocational           math     gendermale 
#&gt;    2.752418105   -0.424045918   -1.238680841   -0.006791582   -0.257120287 
#&gt; Coefficients modeling the precision (with log link):
#&gt;    (Intercept)   progAcademic progVocational 
#&gt;       1.109533      -1.083443      -1.517825

summary(fit)
#&gt; 
#&gt; Negative Binomial Regression - Expectation-Maximization Algorithm
#&gt; 
#&gt; Call:  
#&gt; mixpoissonreg(formula = daysabs ~ prog + math + gender | prog, 
#&gt;     data = Attendance)
#&gt; 
#&gt; 
#&gt; Pearson residuals:
#&gt;      RSS      Min       1Q   Median       3Q      Max 
#&gt; 323.6397  -1.0648  -0.7204  -0.3654   0.3064   4.8776 
#&gt; 
#&gt; Coefficients modeling the mean (with  link):
#&gt;                 Estimate Std.error z-value Pr(&gt;|z|)    
#&gt; (Intercept)     2.752418  0.152613  18.035  &lt; 2e-16 ***
#&gt; progAcademic   -0.424046  0.132369  -3.204  0.00136 ** 
#&gt; progVocational -1.238681  0.173155  -7.154 8.45e-13 ***
#&gt; math           -0.006792  0.002274  -2.986  0.00283 ** 
#&gt; gendermale     -0.257120  0.116934  -2.199  0.02789 *  
#&gt; 
#&gt; Coefficients modeling the precision (with  link):
#&gt;                Estimate Std.error z-value Pr(&gt;|z|)    
#&gt; (Intercept)      1.1095    0.2783   3.987 6.68e-05 ***
#&gt; progAcademic    -1.0834    0.3074  -3.524 0.000424 ***
#&gt; progVocational  -1.5178    0.3395  -4.471 7.79e-06 ***
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
#&gt; 
#&gt; Efron's pseudo R-squared:  0.1861217 
#&gt; Number of iterations of the EM algorithm = 1930</a></code></pre>
<p>There are also several methods implemented:</p>
<ul>
<li>Visualization: <code>plot</code> (base-R visualization) ; <code>autoplot</code> (<em>ggplot2</em> visualization) ; <code>local_influence_plot</code> (base-R visualization) ; <code>local_influence_autoplot</code> (<em>ggplot2</em> visualization)</li>
<li>Inference: <code>coeftest</code> ; <code>coefci</code> ; <code><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html">lmtest::lrtest</a></code> (works with the default method) ; <code><a href="https://rdrr.io/pkg/lmtest/man/waldtest.html">lmtest::waldtest</a></code> (works with the default method) ; <code>predict</code>
</li>
<li>Residual analysis: <code>residuals</code>
</li>
<li>Global influence analysis: <code>influence</code> ; <code>cooks.distance</code> ; <code>hatvalues</code>
</li>
<li>Local influence analysis: <code>local_influence</code>
</li>
<li>Tidyverse compatibility: <code>augment</code> ; <code>glance</code> ; <code>tidy</code> ; <code>tidy_local_influence</code> ; <code>local_influence_benchmarks</code>
</li>
</ul>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/vpnsctl/mixpoissonreg/">https://​github.com/​vpnsctl/​mixpoissonreg/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/vpnsctl/mixpoissonreg/issues">https://​github.com/​vpnsctl/​mixpoissonreg/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Alexandre B. Simas <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-2562-2829" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Wagner Barreto-Souza <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-0831-7881" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/vpnsctl/mixpoissonreg/main"><img src="https://img.shields.io/badge/devel%20version-1.0.0-blue.svg"></a></li>
<li><a href="https://github.com/vpnsctl/mixpoissonreg/actions"><img src="https://github.com/vpnsctl/mixpoissonreg/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://codecov.io/gh/vpnsctl/mixpoissonreg"><img src="https://codecov.io/gh/vpnsctl/mixpoissonreg/branch/main/graph/badge.svg?token=JXDPBKWGYE" alt="Codecov test coverage"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Alexandre B. Simas, Wagner Barreto-Souza.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
