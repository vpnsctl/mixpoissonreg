<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to mixpoissonreg • mixpoissonreg</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to mixpoissonreg">
<meta property="og:description" content="mixpoissonreg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mixpoissonreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mixpoissonreg.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/influence-mixpoissonreg.html">Global and local influence analysis with the *mixpoissonreg* package</a>
    </li>
    <li>
      <a href="../articles/intervals-mixpoissonreg.html">Confidence and prediction intervals with  the mixpoissonreg package</a>
    </li>
    <li>
      <a href="../articles/ml-mixpoissonreg.html">Maximum-likelihood estimation with the mixpoissonreg package</a>
    </li>
    <li>
      <a href="../articles/plots-mixpoissonreg.html">plots-mixpoissonreg</a>
    </li>
    <li>
      <a href="../articles/tidyverse-mixpoissonreg.html">tidyverse-mixpoissonreg</a>
    </li>
    <li>
      <a href="../articles/tutorial-mixpoissonreg.html">tutorial-mixpoissonreg</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/vpnsctl/mixpoissonreg/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to mixpoissonreg</h1>
                        <h4 class="author">Alexandre B. Simas</h4>
            
            <h4 class="date">2020-12-31</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/vpnsctl/mixpoissonreg/blob/master/vignettes/mixpoissonreg.Rmd"><code>vignettes/mixpoissonreg.Rmd</code></a></small>
      <div class="hidden name"><code>mixpoissonreg.Rmd</code></div>

    </div>

    
    
<div id="what-is-mixpoissonreg-for" class="section level1">
<h1 class="hasAnchor">
<a href="#what-is-mixpoissonreg-for" class="anchor"></a>What is <em>mixpoissonreg</em> for?</h1>
<p>The <em>mixpoissonreg</em> package is useful for fitting and analysing regression models with <strong>overdispersed</strong> count responses. It provides two regression models for overdispersed count data:</p>
<ul>
<li><p>Negative-Binomial regression models;</p></li>
<li><p>Poisson Inverse Gaussian regression models.</p></li>
</ul>
<p>The parameters of the above models may be estimated by the Expectation-Maximization algorithm or by direct maximization of the likelihood function.</p>
<p>There are several functions to aid the user to check the adequacy of the fitted model, perform some inference and study influential observations.</p>
<p>For theoretical details we refer the reader to <a href="https://doi.org/10.1007/s11222-015-9601-6">Barreto-Souza and Simas (2016)</a></p>
</div>
<div id="why-use-the-mixpoissonreg-package" class="section level1">
<h1 class="hasAnchor">
<a href="#why-use-the-mixpoissonreg-package" class="anchor"></a>Why use the mixpoissonreg package?</h1>
<p>Some reasons are:</p>
<ul>
<li><p><code>glm</code>-like functions to fit and analyze fitted models</p></li>
<li><p>Useful plots for fitted models available using <code>R</code>’s base graphics or <code>ggplot2</code></p></li>
<li><p>Estimation of parameters via EM-algorithm</p></li>
<li><p>Easy to do inference on fitted models with help of <code>lmtest</code> package</p></li>
<li><p>Regression structure for the precision parameter</p></li>
<li><p>Several global and local influence measures implemented (along with corresponding plots)</p></li>
<li><p>Compatibility with the <code>tidyverse</code></p></li>
</ul>
<p>We will now delve into the reasons above in more detail.</p>
<div id="glm-like-functions-to-fit-and-analyze-fitted-models" class="section level2">
<h2 class="hasAnchor">
<a href="#glm-like-functions-to-fit-and-analyze-fitted-models" class="anchor"></a><code>glm</code>-like functions to fit and analyze fitted models</h2>
<p>If you know how to fit <code>glm</code> models then you already know how to fit <code>mixpoissonreg</code> models. You use a <code>formula</code> expression for the regression with respect to mean parameter:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vpnsctl/mixpoissonreg/">mixpoissonreg</a></span><span class="op">)</span>

<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixpoissonreg.html">mixpoissonreg</a></span><span class="op">(</span><span class="va">daysabs</span> <span class="op">~</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">math</span> <span class="op">+</span> <span class="va">prog</span>, data <span class="op">=</span> <span class="va">Attendance</span><span class="op">)</span></code></pre></div>
<p>If you do not provide further arguments, the <em>mixpoissonreg</em> package will fit a <em>Negative-Binomial</em> model with a <em>log</em> link function for the mean estimated via EM-algorithm. Just like you would do with a <code>glm</code> fit, you can just type <code>fit</code> to get a simplified output of the fit, or get a summary, by typing <code><a href="https://rdrr.io/r/base/summary.html">summary(fit)</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Negative Binomial Regression - Expectation-Maximization Algorithm</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; mixpoissonreg(formula = daysabs ~ gender + math + prog, data = Attendance)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients modeling the mean (with log link):</span>
<span class="co">#&gt;    (Intercept)     gendermale           math   progAcademic progVocational </span>
<span class="co">#&gt;    2.707563981   -0.211066195   -0.006235448   -0.424575877   -1.252812675 </span>
<span class="co">#&gt; Coefficients modeling the precision (with identity link):</span>
<span class="co">#&gt; (Intercept) </span>
<span class="co">#&gt;    1.047289</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Negative Binomial Regression - Expectation-Maximization Algorithm</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; mixpoissonreg(formula = daysabs ~ gender + math + prog, data = Attendance)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Pearson residuals:</span>
<span class="co">#&gt;      RSS      Min       1Q   Median       3Q      Max </span>
<span class="co">#&gt; 345.7857  -0.9662  -0.7356  -0.3351   0.3132   5.5512 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients modeling the mean (with  link):</span>
<span class="co">#&gt;                 Estimate Std.error z-value Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)     2.707564  0.203069  13.333  &lt; 2e-16 ***</span>
<span class="co">#&gt; gendermale     -0.211066  0.122373  -1.725   0.0846 .  </span>
<span class="co">#&gt; math           -0.006235  0.002491  -2.503   0.0123 *  </span>
<span class="co">#&gt; progAcademic   -0.424576  0.181772  -2.336   0.0195 *  </span>
<span class="co">#&gt; progVocational -1.252813  0.201381  -6.221 4.94e-10 ***</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients modeling the precision (with  link):</span>
<span class="co">#&gt;             Estimate Std.error z-value Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)   1.0473    0.1082   9.675   &lt;2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Efron's pseudo R-squared:  0.1854615 </span>
<span class="co">#&gt; Number of iterations of the EM algorithm = 1</span></code></pre></div>
<p>If you want to fit a Poisson Inverse Gaussian regression model, just set the <code>model</code> argument to <code>PIG</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_pig</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixpoissonreg.html">mixpoissonreg</a></span><span class="op">(</span><span class="va">daysabs</span> <span class="op">~</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">math</span> <span class="op">+</span> <span class="va">prog</span>, model <span class="op">=</span> <span class="st">"PIG"</span>, data <span class="op">=</span> <span class="va">Attendance</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_pig</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Poisson Inverse Gaussian Regression - Expectation-Maximization Algorithm</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; mixpoissonreg(formula = daysabs ~ gender + math + prog, data = Attendance, </span>
<span class="co">#&gt;     model = "PIG")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Pearson residuals:</span>
<span class="co">#&gt;      RSS      Min       1Q   Median       3Q      Max </span>
<span class="co">#&gt; 276.4232  -0.8225  -0.6386  -0.3219   0.3038   5.4969 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients modeling the mean (with  link):</span>
<span class="co">#&gt;                 Estimate Std.error z-value Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)     3.060166  0.227621  13.444  &lt; 2e-16 ***</span>
<span class="co">#&gt; gendermale     -0.244078  0.129011  -1.892 0.058502 .  </span>
<span class="co">#&gt; math           -0.007421  0.002641  -2.810 0.004951 ** </span>
<span class="co">#&gt; progAcademic   -0.719714  0.193040  -3.728 0.000193 ***</span>
<span class="co">#&gt; progVocational -1.591909  0.215375  -7.391 1.45e-13 ***</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients modeling the precision (with  link):</span>
<span class="co">#&gt;             Estimate Std.error z-value Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)   0.7323    0.1121   6.533 6.46e-11 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Efron's pseudo R-squared:  0.1758126 </span>
<span class="co">#&gt; Number of iterations of the EM algorithm = 20</span></code></pre></div>
<p>There are also several standard methods implemented for <code>mixpoissonreg</code> fitted objects: <code>plot</code>, <code>residuals</code>, <code>vcov</code>, <code>influence</code>, <code>cooks.distance</code>, <code>hatvalues</code>, <code>predict</code>, etc.</p>
<p>A fitted <code>mixpoissonreg</code> object is compatible with the <code>lrtest</code>, <code>waldtest</code>, <code>coeftest</code> and <code>coefci</code> methods from the <code>lmtest</code> package, which, for instance, allows one to easily perform ANOVA-like tests for <code>mixpoissonreg</code> models.</p>
<p>We refer the reader to the <a href="tutorial-mixpoissonreg.html">Analyzing overdispersed count data with the <em>mixpoissonreg</em> package</a> vignette for further details on fitting <code>mixpoissonreg</code> objects.</p>
</div>
<div id="useful-plots-for-fitted-models-available-using-rs-base-graphics-or-ggplot2" class="section level2">
<h2 class="hasAnchor">
<a href="#useful-plots-for-fitted-models-available-using-rs-base-graphics-or-ggplot2" class="anchor"></a>Useful plots for fitted models available using <code>R</code>’s base graphics or <code>ggplot2</code>
</h2>
<p>Once you have a fitted <code>mixpoissonreg</code> object, say <code>fit</code>, you can easily produce useful plots by typing <code><a href="https://rdrr.io/r/graphics/plot.html">plot(fit)</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code></pre></div>
<p><img src="mixpoissonreg_files/figure-html/unnamed-chunk-5-1.png" width="700"><img src="mixpoissonreg_files/figure-html/unnamed-chunk-5-2.png" width="700"><img src="mixpoissonreg_files/figure-html/unnamed-chunk-5-3.png" width="700"><img src="mixpoissonreg_files/figure-html/unnamed-chunk-5-4.png" width="700"></p>
<p>You can also have the <code>ggplot2</code> version of the above plots by typing <code><a href="../reference/autoplot.mixpoissonreg.html">autoplot(fit)</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/autoplot.mixpoissonreg.html">autoplot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code></pre></div>
<p><img src="mixpoissonreg_files/figure-html/unnamed-chunk-6-1.png" width="700"><img src="mixpoissonreg_files/figure-html/unnamed-chunk-6-2.png" width="700"><img src="mixpoissonreg_files/figure-html/unnamed-chunk-6-3.png" width="700"><img src="mixpoissonreg_files/figure-html/unnamed-chunk-6-4.png" width="700"></p>
<p>For further details on plots of <code>mixpoissonreg</code> objects, we refer the reader to the <a href="plots-mixpoissonreg.html">Diagnostic plots with the <em>mixpoissonreg</em> package</a> vignette.</p>
</div>
<div id="estimation-of-parameters-via-em-algorithm" class="section level2">
<h2 class="hasAnchor">
<a href="#estimation-of-parameters-via-em-algorithm" class="anchor"></a>Estimation of parameters via EM-algorithm</h2>
<p>The EM-algorithm also tries to find the maximum-likelihood estimate of the parameters. So, why is there advantage on using the EM-algorithm? The reason is purely numerical. Sometimes the log-likelihood function has several local maxima or almost flat, which makes the direct maximization of the likelihood function converge (and making it very difficult not to obtain early convergence) before reaching its maximum. In such situations the EM-algorithm may be able to obtain estimates closer to the maximum-likelihood estimate. However, it has a drawback that it may take much longer to converge on such situations.</p>
<p>We refer the reader to the Supplementary Material of <a href="https://doi.org/10.1007/s11222-015-9601-6">Barreto-Souza and Simas (2016)</a> and to <a href="https://doi.org/10.1080/00949655.2017.1350679">Barreto-Souza and Simas (2017)</a> for numerical studies.</p>
</div>
<div id="easy-to-do-inference-on-fitted-models-with-help-of-lmtest-package" class="section level2">
<h2 class="hasAnchor">
<a href="#easy-to-do-inference-on-fitted-models-with-help-of-lmtest-package" class="anchor"></a>Easy to do inference on fitted models with help of <code>lmtest</code> package</h2>
<p>We can easily perform ANOVA-like tests using the <code>lmtest</code> package. Let us perform a likelihood-ratio test against the NULL model that only contains the intercept:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html">lrtest</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="co">#&gt; Likelihood ratio test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model 1: daysabs ~ gender + math + prog | 1</span>
<span class="co">#&gt; Model 2: daysabs ~ 1 | 1</span>
<span class="co">#&gt;   #Df  LogLik Df  Chisq Pr(&gt;Chisq)    </span>
<span class="co">#&gt; 1   6 -864.15                         </span>
<span class="co">#&gt; 2   2 -896.47 -4 64.638  3.068e-13 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>Now let us perform the Wald test against the NULL model that only contains the intercept:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/waldtest.html">waldtest</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="co">#&gt; Wald test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model 1: daysabs ~ gender + math + prog | 1</span>
<span class="co">#&gt; Model 2: daysabs ~ 1 | 1</span>
<span class="co">#&gt;   Res.Df Df  Chisq Pr(&gt;Chisq)    </span>
<span class="co">#&gt; 1    308                         </span>
<span class="co">#&gt; 2    312 -4 74.257  2.861e-15 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>Let us now consider a reduced model:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_red</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixpoissonreg.html">mixpoissonreg</a></span><span class="op">(</span><span class="va">daysabs</span> <span class="op">~</span> <span class="va">math</span>, data <span class="op">=</span> <span class="va">Attendance</span><span class="op">)</span></code></pre></div>
<p>We can perform a likelihood ratio test of full <code>fit</code> model against the NULL of the reduced model as:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html">lrtest</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">fit_red</span><span class="op">)</span>
<span class="co">#&gt; Likelihood ratio test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model 1: daysabs ~ gender + math + prog | 1</span>
<span class="co">#&gt; Model 2: daysabs ~ math | 1</span>
<span class="co">#&gt;   #Df  LogLik Df  Chisq Pr(&gt;Chisq)    </span>
<span class="co">#&gt; 1   6 -864.15                         </span>
<span class="co">#&gt; 2   3 -888.15 -3 47.999  2.131e-10 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>In the same fashion, we can perform a Wald test of full <code>fit</code> model against the NULL of the reduced model as:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/waldtest.html">waldtest</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">fit_red</span><span class="op">)</span>
<span class="co">#&gt; Wald test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model 1: daysabs ~ gender + math + prog | 1</span>
<span class="co">#&gt; Model 2: daysabs ~ math | 1</span>
<span class="co">#&gt;   Res.Df Df  Chisq Pr(&gt;Chisq)    </span>
<span class="co">#&gt; 1    308                         </span>
<span class="co">#&gt; 2    311 -3 52.537  2.301e-11 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>We can obtain confidence intervals for the estimated parameters by using the <code>coefci</code> method:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coefci</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="co">#&gt;                             2.5 %       97.5 %</span>
<span class="co">#&gt; (Intercept)            2.30955534  3.105572621</span>
<span class="co">#&gt; gendermale            -0.45091355  0.028781163</span>
<span class="co">#&gt; math                  -0.01111851 -0.001352381</span>
<span class="co">#&gt; progAcademic          -0.78084150 -0.068310253</span>
<span class="co">#&gt; progVocational        -1.64751140 -0.858113947</span>
<span class="co">#&gt; (Intercept).precision  0.83512850  1.259450101</span></code></pre></div>
</div>
<div id="regression-structure-for-the-precision-parameter" class="section level2">
<h2 class="hasAnchor">
<a href="#regression-structure-for-the-precision-parameter" class="anchor"></a>Regression structure for the precision parameter</h2>
<p>The <code>mixpoissonreg</code> package allows the regression models to also have a regression structure on the precision parameter. It is very simple to fit such models, one simply write the <code>formula</code> as <code>formula_1 | formula_2</code>, where <code>formula_1</code> corresponds to the regression structure with respect to the mean parameter and contains the response variable and <code>formula_2</code> corresponds to the regression structure with respect to the precision parameter and <strong>does not</strong> contain the response variable.</p>
<p>Consider the following example:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_prec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixpoissonreg.html">mixpoissonreg</a></span><span class="op">(</span><span class="va">daysabs</span> <span class="op">~</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">math</span> <span class="op">+</span> <span class="va">prog</span> <span class="op">|</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">math</span> <span class="op">+</span> <span class="va">prog</span>, 
                          data <span class="op">=</span> <span class="va">Attendance</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_prec</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Negative Binomial Regression - Expectation-Maximization Algorithm</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; mixpoissonreg(formula = daysabs ~ gender + math + prog | gender + </span>
<span class="co">#&gt;     math + prog, data = Attendance)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Pearson residuals:</span>
<span class="co">#&gt;      RSS      Min       1Q   Median       3Q      Max </span>
<span class="co">#&gt; 322.0142  -1.1751  -0.6992  -0.3600   0.3014   4.7178 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients modeling the mean (with  link):</span>
<span class="co">#&gt;                 Estimate Std.error z-value Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)     2.746123  0.147412  18.629  &lt; 2e-16 ***</span>
<span class="co">#&gt; gendermale     -0.245113  0.117967  -2.078  0.03773 *  </span>
<span class="co">#&gt; math           -0.006617  0.002317  -2.856  0.00429 ** </span>
<span class="co">#&gt; progAcademic   -0.425983  0.132144  -3.224  0.00127 ** </span>
<span class="co">#&gt; progVocational -1.269755  0.174444  -7.279 3.37e-13 ***</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients modeling the precision (with  link):</span>
<span class="co">#&gt;                 Estimate Std.error z-value Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)     1.414227  0.343243   4.120 3.79e-05 ***</span>
<span class="co">#&gt; gendermale     -0.208397  0.203692  -1.023 0.306262    </span>
<span class="co">#&gt; math           -0.005123  0.004181  -1.225 0.220458    </span>
<span class="co">#&gt; progAcademic   -1.084418  0.305479  -3.550 0.000385 ***</span>
<span class="co">#&gt; progVocational -1.422051  0.343812  -4.136 3.53e-05 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Efron's pseudo R-squared:  0.1860886 </span>
<span class="co">#&gt; Number of iterations of the EM algorithm = 11</span></code></pre></div>
<p>In the abscence of <code>link.precision</code> argument, a <em>log</em> link will be used as link function for the precision parameter.</p>
</div>
<div id="several-global-and-local-influence-measures-implemented-along-with-corresponding-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#several-global-and-local-influence-measures-implemented-along-with-corresponding-plots" class="anchor"></a>Several global and local influence measures implemented (along with corresponding plots)</h2>
<p>There are several global influence measures implemented. See <code>influence</code>, <code>hatvalues</code>, <code>cooks.distance</code> and their arguments.</p>
<p>The easiest way to perform global influence analysis on a <code>mixpoissonreg</code> fitted object is to obtain the plots related to global influence:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">fit_prec</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="mixpoissonreg_files/figure-html/unnamed-chunk-14-1.png" width="700"><img src="mixpoissonreg_files/figure-html/unnamed-chunk-14-2.png" width="700"><img src="mixpoissonreg_files/figure-html/unnamed-chunk-14-3.png" width="700"></p>
<p>One can also get the <code>ggplot2</code> version of the above plots:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/autoplot.mixpoissonreg.html">autoplot</a></span><span class="op">(</span><span class="va">fit_prec</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="mixpoissonreg_files/figure-html/unnamed-chunk-15-1.png" width="700"><img src="mixpoissonreg_files/figure-html/unnamed-chunk-15-2.png" width="700"><img src="mixpoissonreg_files/figure-html/unnamed-chunk-15-3.png" width="700"></p>
<p>In a similar fashion, there are several local influence measures implemented in the <code>local_influence</code> method. In the same spirit as above, the easiest way to perform local influence analysis on a <code>mixpoissonreg</code> fitted object is to obtain plots by using <code>local_influence_plot</code> method:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/local_influence.html">local_influence_plot</a></span><span class="op">(</span><span class="va">fit_prec</span><span class="op">)</span></code></pre></div>
<p><img src="mixpoissonreg_files/figure-html/unnamed-chunk-16-1.png" width="700"><img src="mixpoissonreg_files/figure-html/unnamed-chunk-16-2.png" width="700"><img src="mixpoissonreg_files/figure-html/unnamed-chunk-16-3.png" width="700"><img src="mixpoissonreg_files/figure-html/unnamed-chunk-16-4.png" width="700"></p>
<p>One can also obtain <code>ggplot2</code> versions of the above plots by using the <code>local_influence_autoplot</code> method:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/tidy_local_influence.html">local_influence_autoplot</a></span><span class="op">(</span><span class="va">fit_prec</span><span class="op">)</span></code></pre></div>
<p><img src="mixpoissonreg_files/figure-html/unnamed-chunk-17-1.png" width="700"><img src="mixpoissonreg_files/figure-html/unnamed-chunk-17-2.png" width="700"><img src="mixpoissonreg_files/figure-html/unnamed-chunk-17-3.png" width="700"><img src="mixpoissonreg_files/figure-html/unnamed-chunk-17-4.png" width="700"></p>
<p>For further details on global and local influence analyses of <code>mixpoissonreg</code> objects, we refer the reader to the <a href="influence-mixpoissonreg.html">Global and local influence analysis with the <em>mixpoissonreg</em> package</a> vignette.</p>
</div>
<div id="compatibility-with-the-tidyverse" class="section level2">
<h2 class="hasAnchor">
<a href="#compatibility-with-the-tidyverse" class="anchor"></a>Compatibility with the <code>tidyverse</code>
</h2>
<p>We provide the standard methods from the <code>broom</code> package, namely <code>augment</code>, <code>glance</code> and <code>tidy</code>, for <code>mixpoissonreg</code> objects:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/augment.mixpoissonreg.html">augment</a></span><span class="op">(</span><span class="va">fit_prec</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 314 x 12</span>
<span class="co">#&gt;    daysabs gender  math prog  .fitted .fittedlwrconf .fitteduprconf .resid</span>
<span class="co">#&gt;      &lt;dbl&gt; &lt;fct&gt;  &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt;  1       4 male      63 Acad…    5.25           4.14           6.66 -0.200</span>
<span class="co">#&gt;  2       4 male      27 Acad…    6.66           5.40           8.22 -0.370</span>
<span class="co">#&gt;  3       2 female    20 Acad…    8.92           7.21          11.0  -0.814</span>
<span class="co">#&gt;  4       3 female    16 Acad…    9.15           7.34          11.4  -0.713</span>
<span class="co">#&gt;  5       3 female     2 Acad…   10.0            7.76          13.0  -0.772</span>
<span class="co">#&gt;  6      13 female    71 Acad…    6.36           5.02           8.07  0.956</span>
<span class="co">#&gt;  7      11 female    63 Acad…    6.71           5.39           8.34  0.599</span>
<span class="co">#&gt;  8       7 male       3 Acad…    7.81           6.04          10.1  -0.102</span>
<span class="co">#&gt;  9      10 male      51 Acad…    5.68           4.58           7.05  0.660</span>
<span class="co">#&gt; 10       9 male      49 Voca…    2.48           1.86           3.30  1.86 </span>
<span class="co">#&gt; # … with 304 more rows, and 4 more variables: .resfit &lt;dbl&gt;, .hat &lt;dbl&gt;,</span>
<span class="co">#&gt; #   .cooksd &lt;dbl&gt;, .gencooksd &lt;dbl&gt;</span>

<span class="fu"><a href="../reference/glance.mixpoissonreg.html">glance</a></span><span class="op">(</span><span class="va">fit_prec</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 9</span>
<span class="co">#&gt;   efron.pseudo.r2 df.null logLik   AIC   BIC df.residual  nobs model.type</span>
<span class="co">#&gt;             &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;int&gt; &lt;int&gt; &lt;chr&gt;     </span>
<span class="co">#&gt; 1           0.186     312  -853. 1726. 1764.         304   314 NB        </span>
<span class="co">#&gt; # … with 1 more variable: est.method &lt;chr&gt;</span>

<span class="fu"><a href="../reference/tidy.mixpoissonreg.html">tidy</a></span><span class="op">(</span><span class="va">fit_prec</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 10 x 6</span>
<span class="co">#&gt;    component term           estimate std.error statistic  p.value</span>
<span class="co">#&gt;    &lt;chr&gt;     &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt;  1 mean      (Intercept)     2.75      0.147       18.6  1.87e-77</span>
<span class="co">#&gt;  2 mean      gendermale     -0.245     0.118       -2.08 3.77e- 2</span>
<span class="co">#&gt;  3 mean      math           -0.00662   0.00232     -2.86 4.29e- 3</span>
<span class="co">#&gt;  4 mean      progAcademic   -0.426     0.132       -3.22 1.27e- 3</span>
<span class="co">#&gt;  5 mean      progVocational -1.27      0.174       -7.28 3.37e-13</span>
<span class="co">#&gt;  6 precision (Intercept)     1.41      0.343        4.12 3.79e- 5</span>
<span class="co">#&gt;  7 precision gendermale     -0.208     0.204       -1.02 3.06e- 1</span>
<span class="co">#&gt;  8 precision math           -0.00512   0.00418     -1.23 2.20e- 1</span>
<span class="co">#&gt;  9 precision progAcademic   -1.08      0.305       -3.55 3.85e- 4</span>
<span class="co">#&gt; 10 precision progVocational -1.42      0.344       -4.14 3.53e- 5</span></code></pre></div>
<p>As seen above, the <code>autoplot</code> method from <code>ggplot2</code> package is also implemented for <code>mixpoissonreg</code> objects.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/autoplot.mixpoissonreg.html">autoplot</a></span><span class="op">(</span><span class="va">fit_prec</span><span class="op">)</span></code></pre></div>
<p><img src="mixpoissonreg_files/figure-html/unnamed-chunk-19-1.png" width="700"><img src="mixpoissonreg_files/figure-html/unnamed-chunk-19-2.png" width="700"><img src="mixpoissonreg_files/figure-html/unnamed-chunk-19-3.png" width="700"><img src="mixpoissonreg_files/figure-html/unnamed-chunk-19-4.png" width="700"></p>
<p>Finally, we provide additional methods related to local influence analysis: <code>tidy_local_influence</code>, <code>local_influence_benchmarks</code> and <code>local_influence_autoplot</code>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/tidy_local_influence.html">tidy_local_influence</a></span><span class="op">(</span><span class="va">fit_prec</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 314 x 5</span>
<span class="co">#&gt;    case_weights hidden_variable mean_explanatory precision_expla…</span>
<span class="co">#&gt;           &lt;dbl&gt;           &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;</span>
<span class="co">#&gt;  1     0.00146         0.000353         0.000533         0.00217 </span>
<span class="co">#&gt;  2     0.000970        0.000268         0.000782         0.00129 </span>
<span class="co">#&gt;  3     0.000712        0.000369         0.000535         0.00132 </span>
<span class="co">#&gt;  4     0.000350        0.000328         0.000875         0.000130</span>
<span class="co">#&gt;  5     0.000680        0.000562         0.00101          0.000701</span>
<span class="co">#&gt;  6     0.00118         0.00387          0.00494          0.000740</span>
<span class="co">#&gt;  7     0.00125         0.00230          0.00396          0.00139 </span>
<span class="co">#&gt;  8     0.00243         0.00127          0.00230          0.00185 </span>
<span class="co">#&gt;  9     0.00107         0.00180          0.00266          0.00160 </span>
<span class="co">#&gt; 10     0.00249         0.00325          0.000340         0.000788</span>
<span class="co">#&gt; # … with 304 more rows, and 1 more variable: simultaneous_explanatory &lt;dbl&gt;</span>

<span class="fu"><a href="../reference/tidy_local_influence.html">local_influence_benchmarks</a></span><span class="op">(</span><span class="va">fit_prec</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 5</span>
<span class="co">#&gt;   case_weights hidden_variable mean_explanatory precision_expla…</span>
<span class="co">#&gt;          &lt;dbl&gt;           &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;</span>
<span class="co">#&gt; 1       0.0140          0.0206           0.0182           0.0195</span>
<span class="co">#&gt; # … with 1 more variable: simultaneous_explanatory &lt;dbl&gt;</span>

<span class="fu"><a href="../reference/tidy_local_influence.html">local_influence_autoplot</a></span><span class="op">(</span><span class="va">fit_prec</span><span class="op">)</span></code></pre></div>
<p><img src="mixpoissonreg_files/figure-html/unnamed-chunk-20-1.png" width="700"><img src="mixpoissonreg_files/figure-html/unnamed-chunk-20-2.png" width="700"><img src="mixpoissonreg_files/figure-html/unnamed-chunk-20-3.png" width="700"><img src="mixpoissonreg_files/figure-html/unnamed-chunk-20-4.png" width="700"></p>
<p>For further details on <code>tidyverse</code> compatibility of <code>mixpoissonreg</code> objects and how to use it to produce nice diagnostics and plots, we refer the reader to the <a href="tidyverse-mixpoissonreg.html"><em>mixpoissonreg</em> in the <em>tidyverse</em></a> vignette.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Alexandre B. Simas, Wagner Barreto-Souza.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
