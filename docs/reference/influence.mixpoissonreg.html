<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Global Influence Diagnostics for Mixed Poisson Regression Models — influence.mixpoissonreg • mixpoissonreg</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Global Influence Diagnostics for Mixed Poisson Regression Models — influence.mixpoissonreg" />
<meta property="og:description" content="These functions provides global influence diagnostic quantities such as Cook's distance, hat values, generalized Cook's distance (through argument
on cooks.distance.mixpoissonreg function), likelihood displacement (through argument
on cooks.distance.mixpoissonreg function) and Q-displacement (through argument
on cooks.distance.mixpoissonreg function)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mixpoissonreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mixpoissonreg.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/influence-mixpoissonreg.html">influence-mixpoissonreg</a>
    </li>
    <li>
      <a href="../articles/intervals-mixpoissonreg.html">intervals-mixpoissonreg</a>
    </li>
    <li>
      <a href="../articles/ml-mixpoissonreg.html">ml-mixpoissonreg</a>
    </li>
    <li>
      <a href="../articles/plots-mixpoissonreg.html">plots-mixpoissonreg</a>
    </li>
    <li>
      <a href="../articles/tidyverse-mixpoissonreg.html">tidyverse-mixpoissonreg</a>
    </li>
    <li>
      <a href="../articles/tutorial-mixpoissonreg.html">tutorial-mixpoissonreg</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vpnsctl/mixpoissonreg/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Global Influence Diagnostics for Mixed Poisson Regression Models</h1>
    <small class="dont-index">Source: <a href='https://github.com/vpnsctl/mixpoissonreg/blob/master/R/3_global_influence.R'><code>R/3_global_influence.R</code></a></small>
    <div class="hidden name"><code>influence.mixpoissonreg.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These functions provides global influence diagnostic quantities such as Cook's distance, hat values, generalized Cook's distance (through argument
on <code>cooks.distance.mixpoissonreg</code> function), likelihood displacement (through argument
on <code>cooks.distance.mixpoissonreg</code> function) and Q-displacement (through argument
on <code>cooks.distance.mixpoissonreg</code> function).</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for mixpoissonreg</span>
<span class='fu'><a href='https://rdrr.io/r/stats/influence.measures.html'>hatvalues</a></span><span class='op'>(</span><span class='va'>model</span>, parameters <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"mean"</span>, <span class='st'>"precision"</span><span class='op'>)</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for mixpoissonreg</span>
<span class='fu'><a href='https://rdrr.io/r/stats/influence.measures.html'>cooks.distance</a></span><span class='op'>(</span>
  <span class='va'>model</span>,
  type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"CD"</span>, <span class='st'>"GCD"</span>, <span class='st'>"GCDmean"</span>, <span class='st'>"GCDprecision"</span>, <span class='st'>"LD"</span>, <span class='st'>"QD"</span><span class='op'>)</span>,
  hat <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"mean"</span>, <span class='st'>"precision"</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S3 method for mixpoissonreg</span>
<span class='fu'><a href='https://rdrr.io/r/stats/lm.influence.html'>influence</a></span><span class='op'>(</span><span class='va'>model</span>, do.coef <span class='op'>=</span> <span class='cn'>TRUE</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>model</th>
      <td><p>a <code>mixpoissonreg</code> object.</p></td>
    </tr>
    <tr>
      <th>parameters</th>
      <td><p>the parameter to which the hat values will be computed. The options are 'mean' and 'precision'. The default is 'mean'. For hatvalues with respect to the mean
the model must be fitted with 'x' set to TRUE, and for hatvalues with respect to the precision the model must be fitted with 'w' set to TRUE.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Currently not used.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>the type of Cook's distance to be used. The options are 'CD', the standard Cook's distance;
'GCD', the generalized Cook's distance with respect to all parameters, Zhu et al. (2001);
'GCDmean', the generalized Cook's distance with respect to the mean parameters;
'GCDprecision', the generalized Cook's distance with respect to the precision parameters;
'LD', the likelihood displacement (also known as likelihood distance), see Cook and Weisberg (1982); 'QD', the Q-displacement, see Zhu et al. (2001).
See 'details' for more informations. For 'GCD', 'GCDmean', 'LD' and 'QD', the model must be fitted with 'x' set to TRUE,
and for 'GCD', 'GCDprecision', 'LD' and 'QD', the model must be fitted with 'w' set to TRUE. For 'CD', if 'hat' is set to 'mean',
the model must be fitted with 'x' set to TRUE, whereas
if 'hat' is set to 'precision', the model must be fitted with 'w' set to TRUE.</p></td>
    </tr>
    <tr>
      <th>hat</th>
      <td><p>hat values <code>H[i,i]</code>. The default is obtained through the second-derivative of the Q-function in the spirit of Zhu et al. (2001) and Pregibon (1981), see details.</p></td>
    </tr>
    <tr>
      <th>do.coef</th>
      <td><p>logical indicating if the the approximation to the change of coefficients values after case removal are desired. The model must be fitted with x = TRUE. See details for further explanations.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For hatvalues of mixed Poisson regression models, we follow Zhu et al. (2001) to consider the negative of the hessian of the Q-function as weight matrix, and follow
Pregibon (1981) to define the 'hat' matrix with respect to this weight matrix. We can consider the hessian of the Q-function with respect to mean-related parameters,
which usually considered. We can also consider the hessian of the Q-function with respect to the precision-related parameters to give rise to hatvalues related to the precision
parameters.</p>
<p>The Generalized Cook's distance and Q-displacement for EM-based models were defined in Zhu et al. (2001) and computed for mixed Poisson regression models
in Barreto-Souza and Simas (2016). We implemented first-order approximation to these quantities to be computationally feasible. These first-order approximations
are available in Barreto-Souza and Simas (2016). We also provide versions of generalized Cook's distance for mean-related or precision-related parameters, whose
details can be found in Barreto-Souza and Simas (2016).</p>
<p>In the influence method we provide a 'do.coef' argument that computes first-order approximations to the impact of removal of each case to each parameter, in the
same spirit as the 'do.coeff' argument in 'influence.lm'.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>DOI:10.1007/s11222-015-9601-6 (<a href='https://doi.org/10.1007/s11222-015-9601-6'>Barreto-Souza and Simas; 2016</a>)</p>
<p>Cook, D.R. and Weisberg, S. (1982) <em>Residuals and Influence in Regression</em>. (New York: Chapman and Hall, 1982)</p>
<p>DOI:10.1214/aos/1176345513 (<a href='https://projecteuclid.org/euclid.aos/1176345513'>Pregibon; 1981</a>)</p>
<p>Zhu, H.T., Lee, S.Y., Wei, B.C., Zhu, J. (2001) <em>Case-deletion measures formodels with incomplete data.</em> Biometrika, 88, 727–737. <a href='https://www.jstor.org/stable/2673442?seq=1'>https://www.jstor.org/stable/2673442?seq=1</a></p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alexandre B. Simas, Wagner Barreto-Souza.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


